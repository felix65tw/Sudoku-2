<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <!-- æ–‡ä»¶é¡å‹è²æ˜ï¼Œå‘Šè¨´ç€è¦½å™¨ä½¿ç”¨HTML5è§£ææ–‡ä»¶ -->
    <meta charset="UTF-8">
    <!-- è¨­ç½®å­—ç¬¦ç·¨ç¢¼ç‚ºUTF-8ï¼Œæ”¯æ´ä¸­æ–‡é¡¯ç¤º -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- è¦–å£è¨­ç½®ï¼Œç¢ºä¿åœ¨ç§»å‹•è¨­å‚™ä¸Šæ­£ç¢ºé¡¯ç¤ºï¼Œç¦æ­¢ç¸®æ”¾ -->
    <title>æ•¸ç¨éŠæˆ²</title>
    <!-- é é¢æ¨™é¡Œ -->
    <style>
        /* 
        CSSè®Šæ•¸å®šç¾©å€åŸŸ
        ä½¿ç”¨CSSè®Šæ•¸ä¾¿æ–¼ä¸»é¡Œç®¡ç†å’Œçµ±ä¸€é¢¨æ ¼
        */
        :root {
            --bg-color: #f5f7fa;           /* é é¢èƒŒæ™¯é¡è‰² */
            --card-bg: #ffffff;            /* å¡ç‰‡èƒŒæ™¯é¡è‰² */
            --text-color: #2c3e50;         /* ä¸»è¦æ–‡å­—é¡è‰² */
            --text-secondary: #7f8c8d;     /* æ¬¡è¦æ–‡å­—é¡è‰² */
            --primary: #3498db;            /* ä¸»è¦é¡è‰²ï¼ˆè—è‰²ï¼‰ */
            --primary-light: #5dade2;      /* æ·ºä¸»è¦é¡è‰² */
            --success: #2ecc71;            /* æˆåŠŸé¡è‰²ï¼ˆç¶ è‰²ï¼‰ */
            --success-light: #58d68d;      /* æ·ºæˆåŠŸé¡è‰² */
            --danger: #e74c3c;             /* å±éšª/éŒ¯èª¤é¡è‰²ï¼ˆç´…è‰²ï¼‰ */
            --warning: #f39c12;            /* è­¦å‘Šé¡è‰²ï¼ˆæ©™è‰²ï¼‰ */
            --highlight: #e8f4fd;          /* é«˜äº®èƒŒæ™¯é¡è‰² */
            --border: #bdc3c7;             /* é‚Šæ¡†é¡è‰² */
            --shadow: rgba(0, 0, 0, 0.1);  /* é™°å½±é¡è‰² */
            --disabled: #95a5a6;           /* ç¦ç”¨ç‹€æ…‹é¡è‰² */
        }

        /* 
        å…¨å±€æ¨£å¼é‡ç½®
        ç¢ºä¿æ‰€æœ‰å…ƒç´ ä½¿ç”¨ç›¸åŒçš„ç›’æ¨¡å‹ï¼Œä¸¦å„ªåŒ–ç§»å‹•ç«¯é«”é©—
        */
        * {
            box-sizing: border-box; /* ä½¿ç”¨border-boxç›’æ¨¡å‹ï¼Œä¾¿æ–¼å°ºå¯¸è¨ˆç®— */
            touch-action: manipulation; /* å„ªåŒ–ç§»å‹•ç«¯è§¸æ‘¸é«”é©—ï¼Œé˜²æ­¢é›™æ“Šç¸®æ”¾ */
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤ç§»å‹•ç«¯é»æ“Šé«˜äº®æ•ˆæœ */
        }

        /* 
        é é¢ä¸»é«”æ¨£å¼
        è¨­ç½®æ•´é«”ä½ˆå±€å’ŒåŸºç¤æ¨£å¼
        */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; /* ä½¿ç”¨ç³»çµ±å­—é«”æ£§ */
            background-color: var(--bg-color); /* ä½¿ç”¨CSSè®Šæ•¸è¨­ç½®èƒŒæ™¯è‰² */
            color: var(--text-color); /* ä½¿ç”¨CSSè®Šæ•¸è¨­ç½®æ–‡å­—é¡è‰² */
            margin: 0; /* ç§»é™¤é è¨­å¤–é‚Šè· */
            padding: 10px; /* æ·»åŠ å…§é‚Šè· */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ—å­å…ƒç´  */
            align-items: center; /* æ°´å¹³å±…ä¸­å­å…ƒç´  */
            min-height: 100vh; /* æœ€å°é«˜åº¦ç‚ºè¦–å£é«˜åº¦ */
            overflow: hidden; /* ç¦æ­¢é é¢æ»¾å‹• */
        }

        /* 
        éŠæˆ²ä¸»å®¹å™¨æ¨£å¼
        é™åˆ¶æœ€å¤§å¯¬åº¦ç‚ºä¹å®®æ ¼å¯¬åº¦ï¼Œä¿æŒæ•´é«”ä½ˆå±€ç·Šæ¹Š
        */
        .game-container {
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            max-width: 400px; /* é™åˆ¶æœ€å¤§å¯¬åº¦ç‚ºä¹å®®æ ¼å¯¬åº¦ */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ—å­å…ƒç´  */
            gap: 6px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è· */
            overflow: hidden; /* é˜²æ­¢å®¹å™¨å…§æ»¾å‹• */
        }

        /* 
        é ‚éƒ¨æ§åˆ¶æ¬„æ¨£å¼
        åŒ…å«åŠŸèƒ½æŒ‰éˆ•å’Œé›£åº¦é¸æ“‡
        */
        .controls-top {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            justify-content: space-between; /* å­å…ƒç´ å…©ç«¯å°é½Š */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 6px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è· */
            flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
        }

        /* 
        åŸºç¤æŒ‰éˆ•æ¨£å¼
        å®šç¾©æ‰€æœ‰æŒ‰éˆ•çš„å…±åŒæ¨£å¼
        */
        .btn {
            padding: 6px 10px; /* å…§é‚Šè· */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’é‚Šæ¡† */
            color: white; /* æ–‡å­—é¡è‰² */
            font-size: 0.9rem; /* å­—é«”å¤§å° */
            font-weight: 600; /* å­—é«”ç²—ç´° */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            transition: all 0.2s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            flex: 1; /* å½ˆæ€§ä½ˆå±€ï¼Œå¹³å‡åˆ†é…ç©ºé–“ */
            min-width: 0; /* å…è¨±ç¸®å°åˆ°0å¯¬åº¦ */
            text-align: center; /* æ–‡å­—å±…ä¸­ */
        }

        /* æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .btn:active {
            transform: scale(0.95); /* é»æ“Šæ™‚ç¸®å°æ•ˆæœ */
        }

        /* ä¸»è¦æŒ‰éˆ•æ¨£å¼ - ç”¨æ–¼æ–°éŠæˆ²æŒ‰éˆ• */
        .btn-primary {
            background-color: var(--primary); /* ä½¿ç”¨ä¸»è¦é¡è‰² */
        }

        /* æ¬¡è¦æŒ‰éˆ•æ¨£å¼ - ç”¨æ–¼é è¨­ç‹€æ…‹çš„åŠŸèƒ½æŒ‰éˆ• */
        .btn-secondary {
            background-color: var(--card-bg); /* ä½¿ç”¨å¡ç‰‡èƒŒæ™¯è‰² */
            color: var(--text-color); /* ä½¿ç”¨ä¸»è¦æ–‡å­—é¡è‰² */
            border: 1px solid var(--border); /* æ·»åŠ é‚Šæ¡† */
        }

        /* é–‹å•Ÿç‹€æ…‹æŒ‰éˆ•æ¨£å¼ - ç”¨æ–¼ç­†è¨˜å’ŒéŸ³æ•ˆé–‹å•Ÿç‹€æ…‹ */
        .btn-on {
            background-color: var(--success); /* ä½¿ç”¨æˆåŠŸé¡è‰² */
            color: white; /* æ–‡å­—é¡è‰²ç‚ºç™½è‰² */
        }

        /* 
        åœ–æ¨™æŒ‰éˆ•æ¨£å¼
        ç§»é™¤èƒŒæ™¯å’Œé‚Šæ¡†ï¼Œåƒ…é¡¯ç¤ºåœ–æ¨™
        */
        .icon-btn {
            background: none; /* ç„¡èƒŒæ™¯ */
            border: none; /* ç„¡é‚Šæ¡† */
            font-size: 1.5rem; /* åœ–æ¨™å¤§å° */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            padding: 8px; /* å…§é‚Šè· */
            border-radius: 6px; /* åœ“è§’é‚Šæ¡† */
            transition: all 0.2s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
        }

        /* åœ–æ¨™æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .icon-btn:active {
            transform: scale(0.95); /* é»æ“Šæ™‚ç¸®å°æ•ˆæœ */
            background-color: rgba(0, 0, 0, 0.1); /* é»æ“Šæ™‚æ·»åŠ èƒŒæ™¯è‰² */
        }

        /* 
        ç‹€æ…‹æ¬„æ¨£å¼
        åŒ…å«è¨ˆæ™‚å™¨å’Œçµ±è¨ˆä¿¡æ¯
        */
        .status-bar {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            justify-content: space-between; /* å­å…ƒç´ å…©ç«¯å°é½Š */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            font-size: 0.7rem; /* å­—é«”å¤§å° */
            padding: 0; /* ç§»é™¤å…§é‚Šè· */
            margin: 0; /* ç§»é™¤å¤–é‚Šè· */
            line-height: 0.1; /* æœ€å°åŒ–è¡Œé«˜ï¼Œé”åˆ°å¹¾ä¹ç„¡è·é›¢ */
            margin-top: 15px; /* æ¸›å°èˆ‡ä¸Šæ–¹åŠŸèƒ½éµçš„é–“è· */
        }

        /* è¨ˆæ™‚å™¨å®¹å™¨æ¨£å¼ */
        .timer-container {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 5px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è·ï¼ˆè¨ˆæ™‚å™¨èˆ‡æš«åœæŒ‰éˆ•ä¹‹é–“5pxï¼‰ */
        }

        /* è¨ˆæ™‚å™¨æ¨£å¼ */
        .timer {
            font-weight: 700; /* å­—é«”åŠ ç²— */
            font-family: monospace; /* ä½¿ç”¨ç­‰å¯¬å­—é«”ï¼Œç¢ºä¿æ•¸å­—å°é½Š */
            color: var(--primary); /* ä½¿ç”¨ä¸»è¦é¡è‰² */
        }

        /* æš«åœæŒ‰éˆ•æ¨£å¼ */
        .pause-btn {
            font-size: 0.7rem; /* å­—é«”å¤§å°èˆ‡è¨ˆæ™‚å™¨ç›¸åŒ */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            color: var(--text-secondary); /* ä½¿ç”¨æ¬¡è¦æ–‡å­—é¡è‰² */
            transition: color 0.2s; /* é¡è‰²éæ¸¡å‹•ç•« */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            width: 5px; /* å›ºå®šå¯¬åº¦ */
            height: 5px; /* å›ºå®šé«˜åº¦ */
        }

        /* æš«åœæŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .pause-btn:hover {
            color: var(--primary); /* æ‡¸åœæ™‚ä½¿ç”¨ä¸»è¦é¡è‰² */
        }

        /* çµ±è¨ˆä¿¡æ¯å®¹å™¨æ¨£å¼ */
        .stats {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            gap: 12px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è· */
        }

        /* å–®å€‹çµ±è¨ˆé …æ¨£å¼ */
        .stat-item {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 4px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è· */
        }

        /* çµ±è¨ˆåœ–æ¨™æ¨£å¼ */
        .stat-icon {
            font-size: 1rem; /* åœ–æ¨™å¤§å° */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
        }

        /* éŒ¯èª¤åœ–æ¨™æ¨£å¼ */
        .stat-icon.error {
            color: var(--danger); /* ä½¿ç”¨å±éšªé¡è‰² */
        }

        /* æç¤ºåœ–æ¨™æ¨£å¼ */
        .stat-icon.hint {
            color: var(--warning); /* ä½¿ç”¨è­¦å‘Šé¡è‰² */
        }

        /* çµ±è¨ˆå€¼æ¨£å¼ */
        .stat-value {
            font-weight: 700; /* å­—é«”åŠ ç²— */
            font-family: monospace; /* ä½¿ç”¨ç­‰å¯¬å­—é«”ï¼Œç¢ºä¿æ•¸å­—å°é½Š */
            min-width: 20px; /* é ç•™å…©ä½æ•¸å­—ç©ºé–“ */
            text-align: center; /* æ–‡å­—å±…ä¸­ */
            color: var(--text-color); /* ä½¿ç”¨ä¸»è¦æ–‡å­—é¡è‰² */
        }

        /* 
        æ•¸ç¨æ£‹ç›¤æ¨£å¼
        ä½¿ç”¨CSS Gridä½ˆå±€å‰µå»º9x9ç¶²æ ¼
        */
        #sudoku-board {
            display: grid; /* ä½¿ç”¨ç¶²æ ¼ä½ˆå±€ */
            grid-template-columns: repeat(9, 1fr); /* 9åˆ—ï¼Œæ¯åˆ—ç­‰å¯¬ */
            grid-template-rows: repeat(9, 1fr); /* 9è¡Œï¼Œæ¯è¡Œç­‰é«˜ */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            aspect-ratio: 1; /* ä¿æŒå¯¬é«˜æ¯”ç‚º1:1ï¼ˆæ­£æ–¹å½¢ï¼‰ */
            background-color: var(--border); /* ä½¿ç”¨é‚Šæ¡†é¡è‰²ä½œç‚ºèƒŒæ™¯ */
            border: 2px solid var(--border); /* æ·»åŠ é‚Šæ¡† */
            gap: 1px; /* å–®å…ƒæ ¼ä¹‹é–“çš„é–“éš™ */
            border-radius: 4px; /* åœ“è§’é‚Šæ¡† */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
            box-shadow: 0 4px 8px var(--shadow); /* æ·»åŠ é™°å½±æ•ˆæœ */
            transition: filter 0.3s ease; /* æ·»åŠ æ¿¾é¡éæ¸¡æ•ˆæœ */
        }

        /* ä¹å®®æ ¼æ¨¡ç³Šæ•ˆæœï¼ˆæš«åœæ™‚ä½¿ç”¨ï¼‰ */
        #sudoku-board.blurred {
            filter: blur(4px); /* æ‡‰ç”¨æ¨¡ç³Šæ•ˆæœ */
            pointer-events: none; /* ç¦ç”¨æ»‘é¼ äº‹ä»¶ */
        }

        /* 
        æ•¸ç¨å–®å…ƒæ ¼æ¨£å¼
        æ¯å€‹å–®å…ƒæ ¼çš„åŸºæœ¬æ¨£å¼
        */
        .cell {
            background-color: var(--card-bg); /* ä½¿ç”¨å¡ç‰‡èƒŒæ™¯è‰² */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            font-size: 1.6rem; /* å¢å¤§ä¹å®®æ ¼å…§æ•¸å­— */
            font-weight: 600; /* å­—é«”åŠ ç²— */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            position: relative; /* ç›¸å°å®šä½ï¼Œç”¨æ–¼ç­†è¨˜ç¶²æ ¼å®šä½ */
            user-select: none; /* é˜²æ­¢æ–‡æœ¬é¸æ“‡ */
        }

        /* åˆå§‹ç·šç´¢æ•¸å­—æ¨£å¼ - æ‰€æœ‰æ•¸å­—éƒ½ä½¿ç”¨é€™å€‹é¡è‰² */
        .cell.clue, .cell.filled {
            color: var(--primary); /* ä½¿ç”¨ä¸»è¦é¡è‰² */
            font-weight: 700; /* å­—é«”åŠ ç²— */
        }

        /* 3x3å®®æ ¼é‚Šæ¡†å¢å¼· */
        .cell.border-right { border-right: 2px solid var(--border); } /* å³å´ç²—é‚Šæ¡† */
        .cell.border-bottom { border-bottom: 2px solid var(--border); } /* åº•éƒ¨ç²—é‚Šæ¡† */

        /* é«˜äº®ç›¸é—œå–®å…ƒæ ¼ï¼ˆåŒä¸€è¡Œã€åˆ—å’Œå®®æ ¼ï¼‰ */
        .cell.highlight-related { background-color: var(--highlight); } /* ä½¿ç”¨é«˜äº®èƒŒæ™¯è‰² */

        /* é¸ä¸­çš„å–®å…ƒæ ¼é«˜äº® */
        .cell.selected { background-color: rgba(52, 152, 219, 0.2) !important; } /* åŠé€æ˜è—è‰²èƒŒæ™¯ */

        /* ç›¸åŒæ•¸å­—é«˜äº® */
        .cell.highlight-same { background-color: rgba(52, 152, 219, 0.3) !important; } /* åŠé€æ˜è—è‰²èƒŒæ™¯ï¼Œç•¥æ·± */

        /* éŒ¯èª¤æ•¸å­—æ¨£å¼ */
        .cell.error { color: var(--danger); } /* ä½¿ç”¨å±éšªé¡è‰² */

        /* 
        ç­†è¨˜ç¶²æ ¼æ¨£å¼ - ç”¨æ–¼é¡¯ç¤ºå€™é¸æ•¸å­—
        ä½¿ç”¨çµ•å°å®šä½è¦†è“‹åœ¨å–®å…ƒæ ¼ä¸Š
        */
        .notes-grid {
            position: absolute; /* çµ•å°å®šä½ */
            top: 0; /* é ‚éƒ¨å°é½Š */
            left: 0; /* å·¦å´å°é½Š */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            height: 100%; /* é«˜åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            display: grid; /* ä½¿ç”¨ç¶²æ ¼ä½ˆå±€ */
            grid-template-columns: repeat(3, 1fr); /* 3åˆ—ï¼Œæ¯åˆ—ç­‰å¯¬ */
            grid-template-rows: repeat(3, 1fr); /* 3è¡Œï¼Œæ¯è¡Œç­‰é«˜ */
            pointer-events: none; /* é˜²æ­¢ç­†è¨˜ç¶²æ ¼å¹²æ“¾å–®å…ƒæ ¼é»æ“Š */
            padding: 1px; /* å…§é‚Šè· */
        }

        /* å–®å€‹ç­†è¨˜æ•¸å­—æ¨£å¼ */
        .note-num {
            font-size: 0.7rem; /* ç­†è¨˜å­—é«” */
            color: var(--text-secondary); /* ä½¿ç”¨æ¬¡è¦æ–‡å­—é¡è‰² */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            line-height: 1; /* è¡Œé«˜ç‚º1 */
            font-weight: 500; /* å­—é«”ç²—ç´° */
        }

        /* é«˜äº®ç­†è¨˜ä¸­çš„ç›¸åŒæ•¸å­— */
        .note-num.highlighted {
            background-color: var(--primary-light); /* ä½¿ç”¨æ·ºä¸»è¦é¡è‰² */
            color: white; /* æ–‡å­—é¡è‰²ç‚ºç™½è‰² */
            border-radius: 2px; /* åœ“è§’é‚Šæ¡† */
            font-weight: 600; /* å­—é«”åŠ ç²— */
        }

        /* 
        æ•¸å­—éµç›¤æ¨£å¼
        åŒ…å«1-9çš„æ•¸å­—æŒ‰éˆ• - æ”¹ç‚ºé•·æ–¹å½¢æŒ‰éˆ•
        */
        .keypad {
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            gap: 6px; /* å­å…ƒç´ ä¹‹é–“çš„é–“è· */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            height: 50px; /* å›ºå®šé«˜åº¦ï¼Œä½¿æŒ‰éˆ•è®Šæˆé•·æ–¹å½¢ */
        }

        /* æ•¸å­—æŒ‰éˆ•æ¨£å¼ - æ”¹ç‚ºé•·æ–¹å½¢ */
        .numpad-btn {
            flex: 1; /* å½ˆæ€§ä½ˆå±€ï¼Œå¹³å‡åˆ†é…ç©ºé–“ */
            background: var(--card-bg); /* ä½¿ç”¨å¡ç‰‡èƒŒæ™¯è‰² */
            border: 1px solid var(--border); /* æ·»åŠ é‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’é‚Šæ¡† */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ—å­å…ƒç´  */
            align-items: center; /* æ°´å¹³å±…ä¸­ */
            justify-content: center; /* å‚ç›´å±…ä¸­ */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            transition: all 0.2s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            /* ç§»é™¤ aspect-ratio: 1; ä½¿æŒ‰éˆ•è®Šæˆé•·æ–¹å½¢ */
        }

        /* æ•¸å­—æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .numpad-btn:active {
            transform: scale(0.95); /* é»æ“Šæ™‚ç¸®å°æ•ˆæœ */
        }

        /* æ•¸å­—æŒ‰éˆ•ä¸­çš„æ•¸å­—æ¨£å¼ */
        .numpad-btn .num {
            font-size: 1.2rem; /* å­—é«”å¤§å° */
            font-weight: 700; /* å­—é«”åŠ ç²— */
            color: var(--primary); /* ä½¿ç”¨ä¸»è¦é¡è‰² */
        }

        /* æ•¸å­—æŒ‰éˆ•ä¸­çš„è¨ˆæ•¸æ¨£å¼ */
        .numpad-btn .count {
            font-size: 0.6rem; /* æ¸›å°å­—é«” */
            color: var(--text-secondary); /* ä½¿ç”¨æ¬¡è¦æ–‡å­—é¡è‰² */
            margin-top: 1px; /* æ¸›å°è¡Œè· */
            line-height: 1; /* æ¸›å°è¡Œè· */
        }

        /* å·²å®Œæˆçš„æ•¸å­—æŒ‰éˆ•è®Šæ·¡ */
        .numpad-btn.faded {
            opacity: 0.4; /* é™ä½ä¸é€æ˜åº¦ */
        }

        /* å»ºè­°æ•¸å­—çªå‡ºé¡¯ç¤º */
        .numpad-btn.suggested {
            border: 2px solid var(--warning); /* ä½¿ç”¨è­¦å‘Šé¡è‰²ä½œç‚ºé‚Šæ¡† */
            animation: pulse 1.5s infinite; /* æ·»åŠ è„ˆè¡å‹•ç•« */
        }

        /* è„ˆè¡å‹•ç•«é—œéµå¹€ */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.4); } /* åˆå§‹ç‹€æ…‹ */
            70% { box-shadow: 0 0 0 6px rgba(243, 156, 18, 0); } /* ä¸­é–“ç‹€æ…‹ */
            100% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0); } /* çµæŸç‹€æ…‹ */
        }

        /* 
        é®ç½©å±¤æ¨£å¼ - ç”¨æ–¼å‹åˆ©ç•Œé¢å’Œæš«åœç•Œé¢
        è¦†è“‹æ•´å€‹å±å¹•çš„åŠé€æ˜å±¤
        */
        .overlay {
            position: fixed; /* å›ºå®šå®šä½ */
            top: 0; /* é ‚éƒ¨å°é½Š */
            left: 0; /* å·¦å´å°é½Š */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰è¦–å£ */
            height: 100%; /* é«˜åº¦100%é©æ‡‰è¦–å£ */
            background: rgba(0, 0, 0, 0.7); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
            display: none; /* é è¨­éš±è— */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            z-index: 1000; /* é«˜z-indexç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
        }

        /* æ¨¡æ…‹å°è©±æ¡†æ¨£å¼ */
        .modal {
            background: var(--card-bg); /* ä½¿ç”¨å¡ç‰‡èƒŒæ™¯è‰² */
            padding: 30px; /* å¢åŠ å…§é‚Šè· */
            border-radius: 16px; /* å¢åŠ åœ“è§’é‚Šæ¡† */
            text-align: center; /* æ–‡å­—å±…ä¸­ */
            max-width: 90%; /* æœ€å¤§å¯¬åº¦ç‚ºè¦–å£å¯¬åº¦çš„90% */
            width: 320px; /* å¢åŠ å›ºå®šå¯¬åº¦ */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); /* å¢åŠ é™°å½±æ•ˆæœ */
            border: 2px solid var(--primary); /* æ·»åŠ é‚Šæ¡† */
            position: relative; /* ç›¸å°å®šä½ */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
        }

        /* å‹åˆ©ç•Œé¢å°ˆç”¨æ¨£å¼ */
        .victory-modal {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); /* ä½¿ç”¨æŸ”å’Œçš„è—è‰²å’Œç²‰è‰²æ¼¸è®ŠèƒŒæ™¯ */
            color: white; /* æ–‡å­—é¡è‰²ç‚ºç™½è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            animation: victory-appear 0.8s ease-out; /* æ·»åŠ å‹åˆ©ç•Œé¢å‹•ç•« */
            overflow: visible; /* å…è¨±è–èª•ç‡ˆé¡¯ç¤ºåœ¨é‚Šç•Œå¤– */
        }

        /* å‹åˆ©ç•Œé¢æ¨™é¡Œæ¨£å¼ */
        .victory-modal h2 {
            margin-top: 0; /* ç§»é™¤é ‚éƒ¨å¤–é‚Šè· */
            font-size: 2.2rem; /* å¢å¤§æ¨™é¡Œå­—é«”å¤§å° */
            margin-bottom: 20px; /* åº•éƒ¨å¤–é‚Šè· */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* æ·»åŠ æ–‡å­—é™°å½± */
        }

        /* å‹åˆ©ç•Œé¢æ®µè½æ¨£å¼ */
        .victory-modal p {
            color: rgba(255, 255, 255, 0.9); /* ä½¿ç”¨åŠé€æ˜ç™½è‰² */
            margin-bottom: 20px; /* åº•éƒ¨å¤–é‚Šè· */
            font-size: 1.1rem; /* å¢å¤§æ®µè½å­—é«”å¤§å° */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3); /* æ·»åŠ æ–‡å­—é™°å½± */
        }

        /* å‹åˆ©ç•Œé¢æŒ‰éˆ•æ¨£å¼ */
        .victory-modal .modal-btn {
            background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            color: #667eea; /* ä½¿ç”¨æ¼¸è®ŠèƒŒæ™¯çš„é¡è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’é‚Šæ¡† */
            font-size: 1.1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            padding: 12px 24px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            font-weight: 600; /* å­—é«”åŠ ç²— */
        }

        /* å‹åˆ©ç•Œé¢æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .victory-modal .modal-btn:hover {
            background: white; /* æ‡¸åœæ™‚èƒŒæ™¯è®Šç‚ºç´”ç™½è‰² */
            transform: translateY(-2px); /* æ‡¸åœæ™‚å‘ä¸Šç§»å‹• */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* æ‡¸åœæ™‚æ·»åŠ é™°å½± */
        }

        /* å‹åˆ©ç•Œé¢æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .victory-modal .modal-btn:active {
            transform: translateY(0); /* é»æ“Šæ™‚æ¢å¾©åŸä½ */
        }

        /* æš«åœç•Œé¢å°ˆç”¨æ¨£å¼ - ä¿®æ”¹ç‚ºæŸ”å’Œé¡è‰² */
        .pause-modal {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); /* ä½¿ç”¨æŸ”å’Œçš„è—è‰²å’Œç²‰è‰²æ¼¸è®ŠèƒŒæ™¯ */
            color: white; /* æ–‡å­—é¡è‰²ç‚ºç™½è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
        }

        /* æš«åœç•Œé¢æ¨™é¡Œæ¨£å¼ */
        .pause-modal h2 {
            margin-top: 0; /* ç§»é™¤é ‚éƒ¨å¤–é‚Šè· */
            font-size: 1.8rem; /* å¢å¤§æ¨™é¡Œå­—é«”å¤§å° */
            margin-bottom: 15px; /* åº•éƒ¨å¤–é‚Šè· */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* æ·»åŠ æ–‡å­—é™°å½± */
        }

        /* æš«åœç•Œé¢æ®µè½æ¨£å¼ */
        .pause-modal p {
            color: rgba(255, 255, 255, 0.9); /* ä½¿ç”¨åŠé€æ˜ç™½è‰² */
            margin-bottom: 20px; /* åº•éƒ¨å¤–é‚Šè· */
            font-size: 1rem; /* æ®µè½å­—é«”å¤§å° */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3); /* æ·»åŠ æ–‡å­—é™°å½± */
        }

        /* æš«åœç•Œé¢æŒ‰éˆ•æ¨£å¼ */
        .pause-modal .modal-btn {
            background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            color: #66a6ff; /* ä½¿ç”¨æŸ”å’Œçš„è—è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’é‚Šæ¡† */
            font-size: 1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            padding: 10px 20px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            font-weight: 600; /* å­—é«”åŠ ç²— */
        }

        /* æš«åœç•Œé¢æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .pause-modal .modal-btn:hover {
            background: white; /* æ‡¸åœæ™‚èƒŒæ™¯è®Šç‚ºç´”ç™½è‰² */
            transform: translateY(-2px); /* æ‡¸åœæ™‚å‘ä¸Šç§»å‹• */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* æ‡¸åœæ™‚æ·»åŠ é™°å½± */
        }

        /* æš«åœç•Œé¢æŒ‰éˆ•æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .pause-modal .modal-btn:active {
            transform: translateY(0); /* é»æ“Šæ™‚æ¢å¾©åŸä½ */
        }

        /* è–ç¶“ç¶“æ–‡ç•Œé¢å°ˆç”¨æ¨£å¼ */
        .bible-modal {
            background: linear-gradient(135deg, #fdfcfb 0%, #e2d1c3 100%); /* ä½¿ç”¨æŸ”å’Œçš„ç±³è‰²æ¼¸è®ŠèƒŒæ™¯ */
            color: #5d4037; /* ä½¿ç”¨æ·±æ£•è‰²æ–‡å­— */
            border: 2px solid #8d6e63; /* æ·»åŠ æ£•è‰²é‚Šæ¡† */
            /* ç§»é™¤æœ€å¤§é«˜åº¦é™åˆ¶å’Œæ»¾å‹•æ¢è¨­ç½®ï¼Œæ”¹ç‚ºè‡ªå‹•é«˜åº¦ */
            overflow-y: visible; /* å…è¨±å…§å®¹è‡ªç„¶é¡¯ç¤ºï¼Œä¸æ·»åŠ æ»¾å‹•æ¢ */
            width: 90%; /* å¢åŠ å¯¬åº¦ */
            max-width: 500px; /* å¢åŠ æœ€å¤§å¯¬åº¦ */
            max-height: 90vh; /* è¨­ç½®æœ€å¤§é«˜åº¦ç‚ºè¦–å£çš„90%ï¼Œç¢ºä¿ä¸æœƒè¶…å‡ºå±å¹• */
        }

        /* è–ç¶“ç¶“æ–‡ç•Œé¢æ¨™é¡Œæ¨£å¼ */
        .bible-modal h2 {
            margin-top: 0; /* ç§»é™¤é ‚éƒ¨å¤–é‚Šè· */
            font-size: 1.8rem; /* å¢å¤§æ¨™é¡Œå­—é«”å¤§å° */
            margin-bottom: 20px; /* åº•éƒ¨å¤–é‚Šè· */
            color: #5d4037; /* ä½¿ç”¨æ·±æ£•è‰² */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* æ·»åŠ æ–‡å­—é™°å½± */
            border-bottom: 2px solid #8d6e63; /* æ·»åŠ åº•éƒ¨é‚Šæ¡† */
            padding-bottom: 10px; /* åº•éƒ¨å…§é‚Šè· */
        }

        /* è–ç¶“ç¶“æ–‡å…§å®¹æ¨£å¼ */
        .bible-content {
            text-align: left; /* æ–‡å­—å·¦å°é½Š */
            line-height: 1.8; /* å¢åŠ è¡Œé«˜æé«˜å¯è®€æ€§ */
            font-size: 1.1rem; /* å¢å¤§å­—é«”å¤§å° */
            color: #4e342e; /* ä½¿ç”¨æ·±æ£•è‰² */
            /* ç§»é™¤æœ€å¤§é«˜åº¦å’Œæ»¾å‹•æ¢è¨­ç½® */
            overflow-y: visible; /* ç¢ºä¿å…§å®¹è‡ªç„¶é¡¯ç¤ºï¼Œä¸æ·»åŠ æ»¾å‹•æ¢ */
            padding: 15px; /* å¢åŠ å…§é‚Šè· */
            background: rgba(255, 255, 255, 0.8); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            border-radius: 8px; /* åœ“è§’é‚Šæ¡† */
            margin-bottom: 20px; /* åº•éƒ¨å¤–é‚Šè· */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* æ·»åŠ é™°å½±æ•ˆæœ */
        }

        /* è–ç¶“ç¶“æ–‡æ®µè½æ¨£å¼ - æ”¹ç‚ºå‡¸æ’ï¼ˆæ‡¸æ›ç¸®é€²ï¼‰ */
        .bible-verse {
            margin-bottom: 15px; /* å¢åŠ åº•éƒ¨å¤–é‚Šè· */
            padding: 8px 0; /* ä¸Šä¸‹å…§é‚Šè· */
            border-bottom: 1px dashed #d7ccc8; /* æ·»åŠ åº•éƒ¨è™›ç·šé‚Šæ¡† */
            padding-left: 2.5em; /* å·¦å´å…§é‚Šè·ï¼Œç‚ºç¯€è™Ÿç•™å‡ºç©ºé–“ */
            text-indent: -2.5em; /* è² æ•¸ç¸®é€²ï¼Œå¯¦ç¾å‡¸æ’æ•ˆæœ */
        }

        /* æœ€å¾Œä¸€ç¯€ç¶“æ–‡ç§»é™¤åº•éƒ¨é‚Šæ¡† */
        .bible-verse:last-child {
            border-bottom: none; /* ç§»é™¤åº•éƒ¨é‚Šæ¡† */
        }

        /* è–ç¶“ç¶“æ–‡ç¯€è™Ÿæ¨£å¼ */
        .verse-number {
            font-weight: bold; /* åŠ ç²— */
            color: #8d6e63; /* ä½¿ç”¨æ£•è‰² */
            margin-right: 8px; /* å³å´å¤–é‚Šè· */
            display: inline-block; /* è¨­ç½®ç‚ºè¡Œå…§å¡Šå…ƒç´  */
            width: 2.5em; /* å›ºå®šå¯¬åº¦ï¼Œç¢ºä¿å°é½Š */
            text-align: right; /* æ–‡å­—å³å°é½Š */
        }

        /* è–ç¶“ç¶“æ–‡ç•Œé¢æŒ‰éˆ•æ¨£å¼ */
        .bible-modal .modal-btn {
            background: #8d6e63; /* ä½¿ç”¨æ£•è‰²èƒŒæ™¯ */
            color: white; /* æ–‡å­—é¡è‰²ç‚ºç™½è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’é‚Šæ¡† */
            font-size: 1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            padding: 12px 24px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            font-weight: 600; /* å­—é«”åŠ ç²— */
            margin-top: 10px; /* é ‚éƒ¨å¤–é‚Šè· */
        }

        /* è–ç¶“ç¶“æ–‡ç•Œé¢æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .bible-modal .modal-btn:hover {
            background: #6d4c41; /* æ‡¸åœæ™‚ä½¿ç”¨æ›´æ·±çš„æ£•è‰² */
            transform: translateY(-2px); /* æ‡¸åœæ™‚å‘ä¸Šç§»å‹• */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* æ‡¸åœæ™‚æ·»åŠ é™°å½± */
        }

        /* å‹åˆ©ç•Œé¢å‡ºç¾å‹•ç•« */
        @keyframes victory-appear {
            0% {
                transform: scale(0.5) rotate(-10deg); /* åˆå§‹ç‹€æ…‹ï¼šç¸®å°ä¸¦æ—‹è½‰ */
                opacity: 0; /* å®Œå…¨é€æ˜ */
            }
            70% {
                transform: scale(1.05) rotate(5deg); /* ä¸­é–“ç‹€æ…‹ï¼šç¨å¾®æ”¾å¤§ä¸¦æ—‹è½‰ */
                opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
            }
            100% {
                transform: scale(1) rotate(0); /* æœ€çµ‚ç‹€æ…‹ï¼šæ­£å¸¸å¤§å°å’Œè§’åº¦ */
                opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
            }
        }

        /* è–èª•ç‡ˆå®¹å™¨æ¨£å¼ */
        .christmas-lights {
            position: absolute; /* çµ•å°å®šä½ */
            top: -20px; /* é ‚éƒ¨ä½ç½®ï¼Œç¨å¾®è¶…å‡ºæ¨¡æ…‹æ¡† */
            left: 0; /* å·¦å´å°é½Š */
            width: 100%; /* å¯¬åº¦100%é©æ‡‰çˆ¶å®¹å™¨ */
            height: 30px; /* å›ºå®šé«˜åº¦ */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            justify-content: space-around; /* å­å…ƒç´ å‡å‹»åˆ†ä½ˆ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            z-index: 10; /* æé«˜z-indexï¼Œç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
        }

        /* å–®å€‹è–èª•ç‡ˆæ¨£å¼ */
        .light {
            width: 15px; /* å›ºå®šå¯¬åº¦ */
            height: 15px; /* å›ºå®šé«˜åº¦ */
            border-radius: 50%; /* åœ“å½¢ */
            animation: light-twinkle 1.5s infinite; /* æ·»åŠ é–ƒçˆå‹•ç•« */
            box-shadow: 0 0 10px currentColor; /* æ·»åŠ ç™¼å…‰æ•ˆæœ */
        }

        /* è–èª•ç‡ˆé–ƒçˆå‹•ç•« */
        @keyframes light-twinkle {
            0%, 100% {
                opacity: 0.3; /* åˆå§‹å’ŒçµæŸç‹€æ…‹ï¼šè¼ƒä½ä¸é€æ˜åº¦ */
                transform: scale(0.8); /* åˆå§‹å’ŒçµæŸç‹€æ…‹ï¼šè¼ƒå°å°ºå¯¸ */
            }
            50% {
                opacity: 1; /* ä¸­é–“ç‹€æ…‹ï¼šå®Œå…¨ä¸é€æ˜ */
                transform: scale(1.2); /* ä¸­é–“ç‹€æ…‹ï¼šè¼ƒå¤§å°ºå¯¸ */
            }
        }

        /* éŒ¯èª¤è¼¸å…¥å‹•ç•«é—œéµå¹€ */
        @keyframes shake {
            0% { transform: translateX(0); } /* åˆå§‹ä½ç½® */
            25% { transform: translateX(-3px); } /* å‘å·¦ç§»å‹• */
            50% { transform: translateX(3px); } /* å‘å³ç§»å‹• */
            75% { transform: translateX(-3px); } /* å†æ¬¡å‘å·¦ç§»å‹• */
            100% { transform: translateX(0); } /* å›åˆ°åˆå§‹ä½ç½® */
        }

        /* éŒ¯èª¤æ•¸å­—å‹•ç•«æ‡‰ç”¨ */
        .cell.error .main-num {
            animation: shake 0.4s ease-in-out; /* æ‡‰ç”¨æŠ–å‹•å‹•ç•« */
        }

        /* æç¤ºå‹•ç•«é—œéµå¹€ */
        @keyframes text-flash {
            0%, 100% { color: var(--primary); transform: scale(1); } /* åˆå§‹å’ŒçµæŸç‹€æ…‹ */
            50% { color: #f39c12; transform: scale(1.2); } /* ä¸­é–“ç‹€æ…‹ï¼šè®Šè‰²ä¸¦æ”¾å¤§ */
        }

        /* æç¤ºæ•¸å­—å‹•ç•«æ‡‰ç”¨ */
        .cell.hinting .main-num {
            animation: text-flash 0.6s ease-in-out 3; /* æ‡‰ç”¨é–ƒçˆå‹•ç•«ï¼Œé‡è¤‡3æ¬¡ */
        }

        /* é›£åº¦é¸æ“‡ä¸‹æ‹‰èœå–®æ¨£å¼ - ä¿®æ”¹ç‚ºè‹±æ–‡æ–‡å­—é¡¯ç¤º */
        .difficulty-select {
            background: var(--card-bg); /* ä½¿ç”¨å¡ç‰‡èƒŒæ™¯è‰² */
            border: 1px solid var(--border); /* æ·»åŠ é‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’é‚Šæ¡† */
            font-size: 0.9rem; /* èª¿æ•´å­—é«”å¤§å°ä»¥é©æ‡‰è‹±æ–‡æ–‡å­— */
            cursor: pointer; /* æ»‘é¼ æŒ‡é‡æ¨£å¼ */
            padding: 6px 10px; /* èª¿æ•´å…§é‚Šè· */
            transition: all 0.2s; /* éæ¸¡å‹•ç•«æ•ˆæœ */
            display: flex; /* ä½¿ç”¨å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            appearance: none; /* ç§»é™¤é è¨­æ¨£å¼ */
            -webkit-appearance: none; /* ç§»é™¤Webkitç€è¦½å™¨é è¨­æ¨£å¼ */
            -moz-appearance: none; /* ç§»é™¤Firefoxé è¨­æ¨£å¼ */
            color: var(--text-color); /* æ–‡å­—é¡è‰² */
            font-weight: 600; /* å­—é«”åŠ ç²— */
            min-width: 100px; /* è¨­ç½®æœ€å°å¯¬åº¦ä»¥å®¹ç´è‹±æ–‡æ–‡å­— */
            text-align: center; /* æ–‡å­—å±…ä¸­ */
            text-align-last: center; /* ç¢ºä¿é¸ä¸­é …åœ¨Firefoxä¸­å±…ä¸­ */
        }

        /* é›£åº¦é¸æ“‡ä¸‹æ‹‰èœå–®æ¿€æ´»ç‹€æ…‹æ•ˆæœ */
        .difficulty-select:active {
            transform: scale(0.95); /* é»æ“Šæ™‚ç¸®å°æ•ˆæœ */
            background-color: rgba(0, 0, 0, 0.05); /* é»æ“Šæ™‚æ·»åŠ èƒŒæ™¯è‰² */
        }

        /* é›£åº¦é¸æ“‡ä¸‹æ‹‰èœå–®é¸é …æ¨£å¼ */
        .difficulty-select option {
            text-align: center; /* é¸é …æ–‡å­—å±…ä¸­ */
            font-weight: 600; /* å­—é«”åŠ ç²— */
        }

        /* 
        éŸ¿æ‡‰å¼è¨­è¨ˆ - é‡å°å°å±å¹•è¨­å‚™å„ªåŒ–
        ç•¶å±å¹•å¯¬åº¦å°æ–¼480pxæ™‚æ‡‰ç”¨ä»¥ä¸‹æ¨£å¼
        */
        @media (max-width: 480px) {
            .controls-top {
                gap: 4px; /* æ¸›å°å­å…ƒç´ ä¹‹é–“çš„é–“è· */
            }
            
            .btn {
                padding: 5px 8px; /* æ¸›å°å…§é‚Šè· */
                font-size: 0.8rem; /* æ¸›å°å­—é«”å¤§å° */
            }
            
            .cell {
                font-size: 1.4rem; /* æ¸›å°å–®å…ƒæ ¼å…§æ•¸å­—å¤§å° */
            }
            
            .numpad-btn .num {
                font-size: 1.1rem; /* æ¸›å°æ•¸å­—æŒ‰éˆ•ä¸­æ•¸å­—å¤§å° */
            }
            
            .icon-btn {
                font-size: 1.3rem; /* æ¸›å°åœ–æ¨™å¤§å° */
            }
            
            .stat-icon {
                font-size: 0.9rem; /* æ¸›å°çµ±è¨ˆåœ–æ¨™å¤§å° */
            }
            
            .keypad {
                height: 45px; /* æ¸›å°æ•¸å­—éµç›¤é«˜åº¦ */
            }
            
            .modal {
                padding: 20px; /* æ¸›å°æ¨¡æ…‹å°è©±æ¡†å…§é‚Šè· */
                width: 280px; /* æ¸›å°æ¨¡æ…‹å°è©±æ¡†å¯¬åº¦ */
            }
            
            .victory-modal h2 {
                font-size: 1.8rem; /* æ¸›å°å‹åˆ©ç•Œé¢æ¨™é¡Œå­—é«”å¤§å° */
            }
            
            .victory-modal p {
                font-size: 1rem; /* æ¸›å°å‹åˆ©ç•Œé¢æ®µè½å­—é«”å¤§å° */
            }
            
            .victory-modal .modal-btn {
                font-size: 1rem; /* æ¸›å°å‹åˆ©ç•Œé¢æŒ‰éˆ•å­—é«”å¤§å° */
            }
            
            .pause-modal h2 {
                font-size: 1.5rem; /* æ¸›å°æš«åœç•Œé¢æ¨™é¡Œå­—é«”å¤§å° */
            }
            
            .pause-modal p {
                font-size: 0.9rem; /* æ¸›å°æš«åœç•Œé¢æ®µè½å­—é«”å¤§å° */
            }
            
            .pause-modal .modal-btn {
                font-size: 0.9rem; /* æ¸›å°æš«åœç•Œé¢æŒ‰éˆ•å­—é«”å¤§å° */
            }
            
            .bible-modal {
                width: 95%; /* åœ¨å°å±å¹•ä¸Šé€²ä¸€æ­¥å¢åŠ å¯¬åº¦ */
                max-width: 95%; /* åœ¨å°å±å¹•ä¸Šé€²ä¸€æ­¥å¢åŠ æœ€å¤§å¯¬åº¦ */
                padding: 15px; /* æ¸›å°å…§é‚Šè·ä»¥ç¯€çœç©ºé–“ */
            }
            
            .bible-modal h2 {
                font-size: 1.5rem; /* æ¸›å°è–ç¶“ç¶“æ–‡ç•Œé¢æ¨™é¡Œå­—é«”å¤§å° */
                margin-bottom: 15px; /* æ¸›å°åº•éƒ¨å¤–é‚Šè· */
            }
            
            .bible-content {
                font-size: 1rem; /* æ¸›å°è–ç¶“ç¶“æ–‡å­—é«”å¤§å° */
                padding: 10px; /* æ¸›å°å…§é‚Šè· */
                line-height: 1.6; /* æ¸›å°è¡Œé«˜ä»¥ç¯€çœç©ºé–“ */
            }
            
            .bible-verse {
                margin-bottom: 12px; /* æ¸›å°åº•éƒ¨å¤–é‚Šè· */
                padding-left: 2em; /* æ¸›å°å·¦å´å…§é‚Šè· */
                text-indent: -2em; /* èª¿æ•´è² æ•¸ç¸®é€² */
            }
            
            .verse-number {
                width: 2em; /* æ¸›å°ç¯€è™Ÿå¯¬åº¦ */
            }
            
            .christmas-lights {
                top: -15px; /* èª¿æ•´é ‚éƒ¨ä½ç½® */
                height: 25px; /* æ¸›å°é«˜åº¦ */
            }
            
            .light {
                width: 12px; /* æ¸›å°è–èª•ç‡ˆå¯¬åº¦ */
                height: 12px; /* æ¸›å°è–èª•ç‡ˆé«˜åº¦ */
            }
            
            .difficulty-select {
                font-size: 0.8rem; /* æ¸›å°é›£åº¦é¸æ“‡å­—é«”å¤§å° */
                min-width: 90px; /* æ¸›å°æœ€å°å¯¬åº¦ */
                padding: 5px 8px; /* æ¸›å°å…§é‚Šè· */
            }
        }
    </style>
</head>
<body>
    <!-- 
    éŠæˆ²ä¸»å®¹å™¨
    é™åˆ¶æœ€å¤§å¯¬åº¦ç‚ºä¹å®®æ ¼å¯¬åº¦ï¼Œä¿æŒæ•´é«”ä½ˆå±€ç·Šæ¹Š
    -->
    <div class="game-container">
        <!-- é ‚éƒ¨æ§åˆ¶æ¬„ - åŠŸèƒ½æŒ‰éˆ• -->
        <div class="controls-top">
            <!-- é›£æ˜“é¸æ“‡ä¸‹æ‹‰èœå–® - æ”¹ç‚ºè‹±æ–‡æ–‡å­—è¡¨ç¤º -->
            <select class="difficulty-select" id="difficulty">
                <option value="Beginner">Beginner</option> <!-- å…¥é–€é›£åº¦ -->
                <option value="Easy" selected>Easy</option> <!-- ç°¡å–®é›£åº¦ï¼ˆé è¨­é¸ä¸­ï¼‰-->
                <option value="Medium">Medium</option> <!-- ä¸­ç­‰é›£åº¦ -->
                <option value="Hard">Hard</option> <!-- å›°é›£é›£åº¦ -->
                <option value="Expert">Expert</option> <!-- å°ˆå®¶é›£åº¦ -->
            </select>
            
            <!-- æ–°éŠæˆ²æŒ‰éˆ• - ä½¿ç”¨ç³»çµ±å…§ç½®ç¬¦è™Ÿ ğŸ”„ -->
            <button class="icon-btn" id="btn-new-game" title="New Game">ğŸ”„</button>
            
            <!-- ç­†è¨˜æ¨¡å¼åˆ‡æ›æŒ‰éˆ• - ä½¿ç”¨ç³»çµ±å…§ç½®ç¬¦è™Ÿ ğŸ“ -->
            <button class="icon-btn" id="btn-notes" title="Notes Mode">ğŸ“</button>
            
            <!-- æç¤ºæŒ‰éˆ• - ä½¿ç”¨ç³»çµ±å…§ç½®ç¬¦è™Ÿ ğŸ’¡ -->
            <button class="icon-btn" id="btn-hint" title="Hint">ğŸ’¡</button>
            
            <!-- éŸ³æ•ˆé–‹é—œæŒ‰éˆ• - ä½¿ç”¨ç³»çµ±å…§ç½®ç¬¦è™Ÿ ğŸ”Š æˆ– ğŸ”‡ -->
            <button class="icon-btn" id="btn-sound" title="Sound">ğŸ”Š</button>
        </div>
        
        <!-- ç‹€æ…‹æ¬„ - è¨ˆæ™‚å™¨å’Œçµ±è¨ˆä¿¡æ¯ -->
        <div class="status-bar">
            <!-- è¨ˆæ™‚å™¨å®¹å™¨ -->
            <div class="timer-container">
                <!-- è¨ˆæ™‚å™¨é¡¯ç¤º -->
                <div class="timer" id="timer-display">00:00:00</div>
                <!-- æš«åœæŒ‰éˆ• - ä½¿ç”¨ç³»çµ±å…§ç½®ç¬¦è™Ÿ â¸ï¸ -->
                <div class="pause-btn" id="pause-btn">â¸ï¸</div>
            </div>
            
            <!-- çµ±è¨ˆä¿¡æ¯ -->
            <div class="stats">
                <!-- éŒ¯èª¤æ¬¡æ•¸çµ±è¨ˆ -->
                <div class="stat-item">
                    <!-- éŒ¯èª¤åœ–æ¨™ - ä½¿ç”¨å‰è™Ÿåœ–æ¨™ âŒ -->
                    <div class="stat-icon error">âŒ</div>
                    <!-- éŒ¯èª¤è¨ˆæ•¸é¡¯ç¤º -->
                    <span class="stat-value" id="error-stat">00</span>
                </div>
                <!-- æç¤ºä½¿ç”¨æ¬¡æ•¸çµ±è¨ˆ -->
                <div class="stat-item">
                    <!-- æç¤ºåœ–æ¨™ - ä½¿ç”¨ç‡ˆæ³¡åœ–æ¨™ ğŸ’¡ -->
                    <div class="stat-icon hint">ğŸ’¡</div>
                    <!-- æç¤ºè¨ˆæ•¸é¡¯ç¤º -->
                    <span class="stat-value" id="hint-stat">00</span>
                </div>
            </div>
        </div>
        
        <!-- æ•¸ç¨æ£‹ç›¤ -->
        <div id="sudoku-board"></div>
        
        <!-- æ•¸å­—éµç›¤ - æ”¹ç‚ºé•·æ–¹å½¢æŒ‰éˆ• -->
        <div class="keypad" id="keypad"></div>
    </div>

    <!-- å‹åˆ©ç•Œé¢é®ç½© - ä½¿ç”¨è‹±æ–‡æ–‡å­—å’Œç¾è§€è¨­è¨ˆ -->
    <div class="overlay" id="victory-overlay">
        <div class="modal victory-modal">
            <!-- è–èª•ç‡ˆè£é£¾ -->
            <div class="christmas-lights" id="christmas-lights"></div>
            
            <!-- å‹åˆ©æ¨™é¡Œ - ä½¿ç”¨è‹±æ–‡ -->
            <h2>Congratulations!</h2>
            <!-- è€—æ™‚é¡¯ç¤º -->
            <p id="victory-time-text">Time: 00:00:00</p>
            <!-- çµ±è¨ˆæ•¸æ“š -->
            <p id="victory-stats">Errors: 00, Hints: 00</p>
            <!-- ç¢ºå®šæŒ‰éˆ• - ä½¿ç”¨è‹±æ–‡ -->
            <button class="modal-btn" onclick="closeOverlay()">OK</button>
        </div>
    </div>

    <!-- æš«åœç•Œé¢é®ç½© - ä½¿ç”¨è‹±æ–‡æ–‡å­—å’Œç¾è§€è¨­è¨ˆ -->
    <div class="overlay" id="pause-overlay">
        <div class="modal pause-modal">
            <!-- æš«åœæ¨™é¡Œ - ä½¿ç”¨è‹±æ–‡ -->
            <h2>Game Paused</h2>
            <!-- æš«åœèªªæ˜ - ä½¿ç”¨è‹±æ–‡ -->
            <p>Click the button to continue</p>
            <!-- ç¹¼çºŒæŒ‰éˆ• - ä½¿ç”¨è‹±æ–‡ -->
            <button class="modal-btn" id="resume-btn">Resume</button>
        </div>
    </div>

    <!-- è–ç¶“ç¶“æ–‡ç•Œé¢é®ç½© - é¡¯ç¤ºè©©ç¯‡23ç¯‡ -->
    <div class="overlay" id="bible-overlay">
        <div class="modal bible-modal">
            <!-- è–ç¶“ç¶“æ–‡æ¨™é¡Œ -->
            <h2>è©©ç¯‡ 23ç¯‡</h2>
            <!-- è–ç¶“ç¶“æ–‡å…§å®¹ -->
            <div class="bible-content" id="bible-content">
                <!-- è©©ç¯‡23ç¯‡å…§å®¹å°‡ç”±JavaScriptå‹•æ…‹å¡«å…… -->
            </div>
            <!-- é—œé–‰æŒ‰éˆ• -->
            <button class="modal-btn" id="close-bible-btn">é—œé–‰</button>
        </div>
    </div>

    <script>
        // ======================================================================
        // éŠæˆ²ç‹€æ…‹è®Šæ•¸å®šç¾©
        // ======================================================================

        // æ•¸ç¨ç›¸é—œæ•¸æ“š
        let board = [];          // ç•¶å‰éŠæˆ²ç›¤é¢ï¼ˆåŒ…å«ç©å®¶è¼¸å…¥çš„æ•¸å­—ï¼‰
        let solution = [];       // å®Œæ•´è§£ç­”
        let initial = [];        // åˆå§‹ç›¤é¢ï¼ˆåªåŒ…å«é è¨­çš„ç·šç´¢æ•¸å­—ï¼‰
        let selectedCell = null; // ç•¶å‰é¸ä¸­çš„å–®å…ƒæ ¼åº§æ¨™ {r, c}

        // éŠæˆ²åŠŸèƒ½ç‹€æ…‹
        let notesEnabled = false; // ç­†è¨˜æ¨¡å¼æ˜¯å¦å•Ÿç”¨
        let soundEnabled = true;  // éŸ³æ•ˆæ˜¯å¦å•Ÿç”¨
        let gameOver = false;     // éŠæˆ²æ˜¯å¦çµæŸ
        let isPaused = false;     // éŠæˆ²æ˜¯å¦æš«åœ

        // æ•¸å­—çµ±è¨ˆ
        let counts = Array(10).fill(9); // æ¯å€‹æ•¸å­—é‚„éœ€è¦å¡«å¯«çš„æ•¸é‡ï¼ˆç´¢å¼•1-9å°æ‡‰æ•¸å­—1-9ï¼‰

        // è¨ˆæ™‚å™¨ç›¸é—œ
        let timerInterval = null; // è¨ˆæ™‚å™¨é–“éš”ID
        let timeElapsed = 0;      // å·²è€—è²»çš„æ™‚é–“ï¼ˆç§’ï¼‰

        // éŠæˆ²çµ±è¨ˆ
        let errorCount = 0; // éŒ¯èª¤æ¬¡æ•¸
        let hintCount = 0;  // æç¤ºä½¿ç”¨æ¬¡æ•¸

        // æ…¶ç¥å‹•ç•«ç›¸é—œ
        let celebrationInterval = null; // æ…¶ç¥å‹•ç•«é–“éš”ID
        
        // ç§˜å¯†ä»£ç¢¼ç›¸é—œè®Šæ•¸
        let secretCode = [8,5,8,9,3,8,6,1]; // ç§˜å¯†ä»£ç¢¼åºåˆ—ï¼š85893861
        let inputSequence = []; // è¨˜éŒ„ç©å®¶è¼¸å…¥çš„æ•¸å­—åºåˆ—
        let lastInputTime = 0; // è¨˜éŒ„æœ€å¾Œä¸€æ¬¡è¼¸å…¥çš„æ™‚é–“ï¼Œç”¨æ–¼æª¢æ¸¬è¼¸å…¥è¶…æ™‚
        let isFreshGame = true; // æ¨™è¨˜æ˜¯å¦ç‚ºå…¨æ–°éŠæˆ²ï¼ˆæ²’æœ‰é€²è¡Œéä»»ä½•æ•¸ç¨è¼¸å…¥ï¼‰

        // ======================================================================
        // éŸ³æ•ˆç³»çµ±
        // ======================================================================

        // ä½¿ç”¨Web Audio APIå‰µå»ºéŸ³æ•ˆä¸Šä¸‹æ–‡
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx = null; // éŸ³é »ä¸Šä¸‹æ–‡è®Šæ•¸

        /**
         * åˆå§‹åŒ–éŸ³é »ä¸Šä¸‹æ–‡
         * ç”±æ–¼ç€è¦½å™¨è‡ªå‹•æ’­æ”¾ç­–ç•¥ï¼Œéœ€è¦åœ¨ç”¨æˆ¶äº¤äº’å¾Œæ‰èƒ½å‰µå»ºéŸ³é »ä¸Šä¸‹æ–‡
         */
        function initAudio() {
            if (!audioCtx) {
                audioCtx = new AudioContext();
            }
        }

        /**
         * æ’­æ”¾æŒ‡å®šé¡å‹çš„éŸ³æ•ˆ
         * @param {string} type - éŸ³æ•ˆé¡å‹ï¼š'correct', 'error', 'hint', 'ui', 'win'
         * æ¯ç¨®éŸ³æ•ˆä½¿ç”¨ä¸åŒçš„æŒ¯ç›ªå™¨é¡å‹å’Œé »ç‡ä¾†ç”¢ç”Ÿä¸åŒçš„è²éŸ³æ•ˆæœ
         */
        function playSound(type) {
            // å¦‚æœéŸ³æ•ˆé—œé–‰ï¼Œç›´æ¥è¿”å›
            if (!soundEnabled) return;
            
            // ç¢ºä¿éŸ³é »ä¸Šä¸‹æ–‡å·²åˆå§‹åŒ–
            if (!audioCtx) initAudio();
            
            // å¦‚æœéŸ³é »ä¸Šä¸‹æ–‡è¢«æš«åœï¼Œæ¢å¾©å®ƒï¼ˆç€è¦½å™¨è‡ªå‹•æ’­æ”¾ç­–ç•¥ï¼‰
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const now = audioCtx.currentTime; // ç²å–ç•¶å‰éŸ³é »æ™‚é–“
            
            // æ ¹æ“šä¸åŒéŸ³æ•ˆé¡å‹è¨­ç½®ä¸åŒçš„éŸ³é »åƒæ•¸
            switch (type) {
                case 'correct': // æ­£ç¢ºç­”æ¡ˆéŸ³æ•ˆ - ç°¡çŸ­çš„é«˜é »éŸ³
                    const oscCorrect = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
                    const gainNodeCorrect = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
                    oscCorrect.connect(gainNodeCorrect); // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»
                    gainNodeCorrect.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»åˆ°è¼¸å‡º
                    
                    oscCorrect.type = 'sine'; // ä½¿ç”¨æ­£å¼¦æ³¢
                    oscCorrect.frequency.setValueAtTime(1000, now); // è¨­ç½®é »ç‡ç‚º1000Hz
                    gainNodeCorrect.gain.setValueAtTime(0.3, now); // è¨­ç½®å¢ç›Šç‚º0.3
                    gainNodeCorrect.gain.exponentialRampToValueAtTime(0.01, now + 0.1); // æŒ‡æ•¸è¡°æ¸›
                    oscCorrect.start(now); // é–‹å§‹æ’­æ”¾
                    oscCorrect.stop(now + 0.1); // 0.1ç§’å¾Œåœæ­¢
                    break;
                    
                case 'error': // éŒ¯èª¤ç­”æ¡ˆéŸ³æ•ˆ - ä½æ²‰çš„ä¸‹é™éŸ³
                    const oscError = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
                    const gainNodeError = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
                    oscError.connect(gainNodeError); // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»
                    gainNodeError.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»åˆ°è¼¸å‡º
                    
                    oscError.type = 'sawtooth'; // ä½¿ç”¨é‹¸é½’æ³¢
                    oscError.frequency.setValueAtTime(150, now); // è¨­ç½®é »ç‡ç‚º150Hz
                    oscError.frequency.linearRampToValueAtTime(100, now + 0.3); // ç·šæ€§ä¸‹é™åˆ°100Hz
                    gainNodeError.gain.setValueAtTime(0.2, now); // è¨­ç½®å¢ç›Šç‚º0.2
                    gainNodeError.gain.exponentialRampToValueAtTime(0.01, now + 0.3); // æŒ‡æ•¸è¡°æ¸›
                    oscError.start(now); // é–‹å§‹æ’­æ”¾
                    oscError.stop(now + 0.3); // 0.3ç§’å¾Œåœæ­¢
                    break;
                    
                case 'hint': // æç¤ºéŸ³æ•ˆ - ä¸Šå‡çš„ä¸‰è§’æ³¢
                    const oscHint = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
                    const gainNodeHint = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
                    oscHint.connect(gainNodeHint); // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»
                    gainNodeHint.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»åˆ°è¼¸å‡º
                    
                    oscHint.type = 'triangle'; // ä½¿ç”¨ä¸‰è§’æ³¢
                    oscHint.frequency.setValueAtTime(300, now); // è¨­ç½®é »ç‡ç‚º300Hz
                    oscHint.frequency.linearRampToValueAtTime(800, now + 0.3); // ç·šæ€§ä¸Šå‡åˆ°800Hz
                    gainNodeHint.gain.setValueAtTime(0.1, now); // è¨­ç½®å¢ç›Šç‚º0.1
                    gainNodeHint.gain.linearRampToValueAtTime(0, now + 0.3); // ç·šæ€§è¡°æ¸›åˆ°0
                    oscHint.start(now); // é–‹å§‹æ’­æ”¾
                    oscHint.stop(now + 0.3); // 0.3ç§’å¾Œåœæ­¢
                    break;
                    
                case 'ui': // UIäº¤äº’éŸ³æ•ˆ - çŸ­ä¿ƒçš„æ–¹æ³¢
                    const oscUI = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
                    const gainNodeUI = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
                    oscUI.connect(gainNodeUI); // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»
                    gainNodeUI.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»åˆ°è¼¸å‡º
                    
                    oscUI.type = 'square'; // ä½¿ç”¨æ–¹æ³¢
                    oscUI.frequency.setValueAtTime(800, now); // è¨­ç½®é »ç‡ç‚º800Hz
                    gainNodeUI.gain.setValueAtTime(0.05, now); // è¨­ç½®å¢ç›Šç‚º0.05
                    gainNodeUI.gain.exponentialRampToValueAtTime(0.01, now + 0.05); // æŒ‡æ•¸è¡°æ¸›
                    oscUI.start(now); // é–‹å§‹æ’­æ”¾
                    oscUI.stop(now + 0.05); // 0.05ç§’å¾Œåœæ­¢
                    break;
                    
                case 'win': // å‹åˆ©éŸ³æ•ˆ - äº”å€‹é€£çºŒçš„å’Œå¼¦è²éŸ³
                    playChordSequence(now); // æ’­æ”¾å’Œå¼¦åºåˆ—
                    break;
            }
        }

        /**
         * æ’­æ”¾å’Œå¼¦åºåˆ—ï¼ˆäº”å€‹å’Œå¼¦ä¾æ¬¡æ’­æ”¾ï¼‰
         * @param {number} startTime - é–‹å§‹æ™‚é–“
         * æ’­æ”¾äº”å€‹ä¸åŒçš„å’Œå¼¦ï¼Œæ¯å€‹å’Œå¼¦æŒçºŒ0.3ç§’ï¼Œé–“éš”0.1ç§’
         */
        function playChordSequence(startTime) {
            if (!audioCtx) initAudio(); // ç¢ºä¿éŸ³é »ä¸Šä¸‹æ–‡å·²åˆå§‹åŒ–
            
            // å®šç¾©äº”å€‹ä¸åŒçš„å’Œå¼¦ï¼ˆæ¯å€‹å’Œå¼¦ç”±ä¸‰å€‹éŸ³ç¬¦çµ„æˆï¼‰
            const chords = [
                // Cå¤§ä¸‰å’Œå¼¦ï¼šC(523.25Hz)ã€E(659.25Hz)ã€G(783.99Hz)
                {freq1: 523.25, freq2: 659.25, freq3: 783.99},
                // Få¤§ä¸‰å’Œå¼¦ï¼šF(349.23Hz)ã€A(440.00Hz)ã€C(523.25Hz)
                {freq1: 349.23, freq2: 440.00, freq3: 523.25},
                // Gå¤§ä¸‰å’Œå¼¦ï¼šG(392.00Hz)ã€B(493.88Hz)ã€D(587.33Hz)
                {freq1: 392.00, freq2: 493.88, freq3: 587.33},
                // Amå°ä¸‰å’Œå¼¦ï¼šA(440.00Hz)ã€C(523.25Hz)ã€E(659.25Hz)
                {freq1: 440.00, freq2: 523.25, freq3: 659.25},
                // Cå¤§ä¸‰å’Œå¼¦é«˜å…«åº¦ï¼šC(1046.50Hz)ã€E(1318.51Hz)ã€G(1567.98Hz)
                {freq1: 1046.50, freq2: 1318.51, freq3: 1567.98}
            ];
            
            // ä¾æ¬¡æ’­æ”¾äº”å€‹å’Œå¼¦
            chords.forEach((chord, index) => {
                const chordTime = startTime + index * 0.4; // æ¯å€‹å’Œå¼¦é–“éš”0.4ç§’ï¼ˆ0.3ç§’æ’­æ”¾ + 0.1ç§’é–“éš”ï¼‰
                playChord(chord.freq1, chord.freq2, chord.freq3, chordTime, 0.3); // æ’­æ”¾å’Œå¼¦ï¼ŒæŒçºŒ0.3ç§’
            });
        }

        /**
         * æ’­æ”¾å’Œå¼¦ï¼ˆä¸‰å€‹éŸ³ç¬¦åŒæ™‚æ’­æ”¾ï¼‰
         * @param {number} freq1 - ç¬¬ä¸€å€‹éŸ³ç¬¦çš„é »ç‡ï¼ˆHzï¼‰
         * @param {number} freq2 - ç¬¬äºŒå€‹éŸ³ç¬¦çš„é »ç‡ï¼ˆHzï¼‰
         * @param {number} freq3 - ç¬¬ä¸‰å€‹éŸ³ç¬¦çš„é »ç‡ï¼ˆHzï¼‰
         * @param {number} time - é–‹å§‹æ™‚é–“
         * @param {number} duration - æŒçºŒæ™‚é–“ï¼ˆç§’ï¼‰
         */
        function playChord(freq1, freq2, freq3, time, duration) {
            if (!audioCtx) initAudio(); // ç¢ºä¿éŸ³é »ä¸Šä¸‹æ–‡å·²åˆå§‹åŒ–
            
            // å‰µå»ºä¸‰å€‹æŒ¯ç›ªå™¨å°æ‡‰å’Œå¼¦çš„ä¸‰å€‹éŸ³ç¬¦
            const osc1 = audioCtx.createOscillator(); // å‰µå»ºç¬¬ä¸€å€‹æŒ¯ç›ªå™¨
            const osc2 = audioCtx.createOscillator(); // å‰µå»ºç¬¬äºŒå€‹æŒ¯ç›ªå™¨
            const osc3 = audioCtx.createOscillator(); // å‰µå»ºç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨
            
            // å‰µå»ºä¸‰å€‹å¢ç›Šç¯€é»
            const gain1 = audioCtx.createGain(); // å‰µå»ºç¬¬ä¸€å€‹å¢ç›Šç¯€é»
            const gain2 = audioCtx.createGain(); // å‰µå»ºç¬¬äºŒå€‹å¢ç›Šç¯€é»
            const gain3 = audioCtx.createGain(); // å‰µå»ºç¬¬ä¸‰å€‹å¢ç›Šç¯€é»
            
            // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»ï¼Œå†é€£æ¥åˆ°è¼¸å‡º
            osc1.connect(gain1); // é€£æ¥ç¬¬ä¸€å€‹æŒ¯ç›ªå™¨åˆ°ç¬¬ä¸€å€‹å¢ç›Šç¯€é»
            osc2.connect(gain2); // é€£æ¥ç¬¬äºŒå€‹æŒ¯ç›ªå™¨åˆ°ç¬¬äºŒå€‹å¢ç›Šç¯€é»
            osc3.connect(gain3); // é€£æ¥ç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨åˆ°ç¬¬ä¸‰å€‹å¢ç›Šç¯€é»
            gain1.connect(audioCtx.destination); // é€£æ¥ç¬¬ä¸€å€‹å¢ç›Šç¯€é»åˆ°è¼¸å‡º
            gain2.connect(audioCtx.destination); // é€£æ¥ç¬¬äºŒå€‹å¢ç›Šç¯€é»åˆ°è¼¸å‡º
            gain3.connect(audioCtx.destination); // é€£æ¥ç¬¬ä¸‰å€‹å¢ç›Šç¯€é»åˆ°è¼¸å‡º
            
            // è¨­ç½®æŒ¯ç›ªå™¨é¡å‹ç‚ºæ­£å¼¦æ³¢ï¼Œç”¢ç”Ÿç´”æ·¨çš„éŸ³è‰²
            osc1.type = 'sine'; // è¨­ç½®ç¬¬ä¸€å€‹æŒ¯ç›ªå™¨ç‚ºæ­£å¼¦æ³¢
            osc2.type = 'sine'; // è¨­ç½®ç¬¬äºŒå€‹æŒ¯ç›ªå™¨ç‚ºæ­£å¼¦æ³¢
            osc3.type = 'sine'; // è¨­ç½®ç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨ç‚ºæ­£å¼¦æ³¢
            
            // è¨­ç½®ä¸‰å€‹æŒ¯ç›ªå™¨çš„é »ç‡
            osc1.frequency.setValueAtTime(freq1, time); // è¨­ç½®ç¬¬ä¸€å€‹æŒ¯ç›ªå™¨é »ç‡
            osc2.frequency.setValueAtTime(freq2, time); // è¨­ç½®ç¬¬äºŒå€‹æŒ¯ç›ªå™¨é »ç‡
            osc3.frequency.setValueAtTime(freq3, time); // è¨­ç½®ç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨é »ç‡
            
            // è¨­ç½®å¢ç›Šå€¼ï¼Œèª¿æ•´å„éŸ³ç¬¦çš„éŸ³é‡ä»¥ç²å¾—æ›´å¥½çš„å¹³è¡¡
            gain1.gain.setValueAtTime(0.1, time); // è¨­ç½®ç¬¬ä¸€å€‹å¢ç›Šç¯€é»å¢ç›Šå€¼
            gain2.gain.setValueAtTime(0.08, time); // è¨­ç½®ç¬¬äºŒå€‹å¢ç›Šç¯€é»å¢ç›Šå€¼ï¼ˆç¨ä½ï¼‰
            gain3.gain.setValueAtTime(0.08, time); // è¨­ç½®ç¬¬ä¸‰å€‹å¢ç›Šç¯€é»å¢ç›Šå€¼ï¼ˆç¨ä½ï¼‰
            
            // è¨­ç½®å¢ç›Šè¡°æ¸›ï¼Œä½¿éŸ³ç¬¦å¹³æ»‘çµæŸ
            gain1.gain.exponentialRampToValueAtTime(0.001, time + duration); // ç¬¬ä¸€å€‹å¢ç›Šç¯€é»æŒ‡æ•¸è¡°æ¸›
            gain2.gain.exponentialRampToValueAtTime(0.001, time + duration); // ç¬¬äºŒå€‹å¢ç›Šç¯€é»æŒ‡æ•¸è¡°æ¸›
            gain3.gain.exponentialRampToValueAtTime(0.001, time + duration); // ç¬¬ä¸‰å€‹å¢ç›Šç¯€é»æŒ‡æ•¸è¡°æ¸›
            
            // é–‹å§‹æ’­æ”¾ä¸‰å€‹éŸ³ç¬¦
            osc1.start(time); // é–‹å§‹ç¬¬ä¸€å€‹æŒ¯ç›ªå™¨
            osc2.start(time); // é–‹å§‹ç¬¬äºŒå€‹æŒ¯ç›ªå™¨
            osc3.start(time); // é–‹å§‹ç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨
            
            // åœ¨æŒ‡å®šæ™‚é–“å¾Œåœæ­¢ä¸‰å€‹éŸ³ç¬¦
            osc1.stop(time + duration); // åœæ­¢ç¬¬ä¸€å€‹æŒ¯ç›ªå™¨
            osc2.stop(time + duration); // åœæ­¢ç¬¬äºŒå€‹æŒ¯ç›ªå™¨
            osc3.stop(time + duration); // åœæ­¢ç¬¬ä¸‰å€‹æŒ¯ç›ªå™¨
        }

        /**
         * æ’­æ”¾å–®å€‹éŸ³ç¬¦
         * @param {number} freq - é »ç‡ï¼ˆHzï¼‰
         * @param {number} time - é–‹å§‹æ™‚é–“
         * @param {number} duration - æŒçºŒæ™‚é–“ï¼ˆç§’ï¼‰
         */
        function playNote(freq, time, duration) {
            if (!audioCtx) initAudio(); // ç¢ºä¿éŸ³é »ä¸Šä¸‹æ–‡å·²åˆå§‹åŒ–
            const osc = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
            const gain = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
            osc.connect(gain); // é€£æ¥æŒ¯ç›ªå™¨åˆ°å¢ç›Šç¯€é»
            gain.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»åˆ°è¼¸å‡º
            osc.type = 'sine'; // ä½¿ç”¨æ­£å¼¦æ³¢
            osc.frequency.setValueAtTime(freq, time); // è¨­ç½®é »ç‡
            gain.gain.setValueAtTime(0.1, time); // è¨­ç½®å¢ç›Š
            gain.gain.exponentialRampToValueAtTime(0.01, time + duration); // æŒ‡æ•¸è¡°æ¸›
            osc.start(time); // é–‹å§‹æ’­æ”¾
            osc.stop(time + duration); // æŒ‡å®šæ™‚é–“å¾Œåœæ­¢
        }

        // ======================================================================
        // åˆå§‹åŒ–èˆ‡äº‹ä»¶ç›£è½è¨­ç½®
        // ======================================================================

        /**
         * DOMå…§å®¹åŠ è¼‰å®Œæˆå¾Œåˆå§‹åŒ–éŠæˆ²
         * é€™æ˜¯æ•´å€‹éŠæˆ²çš„å…¥å£é»ï¼Œè¨­ç½®äº†æ‰€æœ‰å¿…è¦çš„åˆå§‹ç‹€æ…‹
         */
        document.addEventListener('DOMContentLoaded', () => {
            createBoardHTML(); // å‰µå»ºæ•¸ç¨æ£‹ç›¤HTMLçµæ§‹
            createKeypadHTML(); // å‰µå»ºæ•¸å­—éµç›¤HTMLçµæ§‹
            startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            setupEventListeners(); // è¨­ç½®äº‹ä»¶ç›£è½å™¨
            loadBibleContent(); // åŠ è¼‰è–ç¶“ç¶“æ–‡å…§å®¹
        });

        /**
         * è¨­ç½®æ‰€æœ‰äº‹ä»¶ç›£è½å™¨
         * ç‚ºæ‰€æœ‰ç”¨æˆ¶äº¤äº’å…ƒç´ ç¶å®šå°æ‡‰çš„äº‹ä»¶è™•ç†å‡½æ•¸
         */
        function setupEventListeners() {
            // æ–°éŠæˆ²æŒ‰éˆ• - é»æ“Šæ™‚é–‹å§‹æ–°éŠæˆ²
            document.getElementById('btn-new-game').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            });
            
            // ç­†è¨˜æ¨¡å¼åˆ‡æ›æŒ‰éˆ• - é»æ“Šæ™‚åˆ‡æ›ç­†è¨˜æ¨¡å¼
            document.getElementById('btn-notes').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleNotes(); // åˆ‡æ›ç­†è¨˜æ¨¡å¼
            });
            
            // æç¤ºæŒ‰éˆ• - é»æ“Šæ™‚ä½¿ç”¨æç¤ºåŠŸèƒ½
            document.getElementById('btn-hint').addEventListener('click', () => {
                useHint(); // ä½¿ç”¨æç¤ºåŠŸèƒ½
            });
            
            // éŸ³æ•ˆåˆ‡æ›æŒ‰éˆ• - é»æ“Šæ™‚åˆ‡æ›éŸ³æ•ˆé–‹é—œ
            document.getElementById('btn-sound').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleSound(); // åˆ‡æ›éŸ³æ•ˆé–‹é—œ
            });
            
            // é›£åº¦é¸æ“‡ä¸‹æ‹‰èœå–® - æ”¹è®Šæ™‚é–‹å§‹æ–°éŠæˆ²
            document.getElementById('difficulty').addEventListener('change', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            });
            
            // æš«åœæŒ‰éˆ• - é»æ“Šæ™‚åˆ‡æ›æš«åœç‹€æ…‹
            document.getElementById('pause-btn').addEventListener('click', () => {
                togglePause(); // åˆ‡æ›æš«åœç‹€æ…‹
            });
            
            // ç¹¼çºŒæŒ‰éˆ• - é»æ“Šæ™‚æ¢å¾©éŠæˆ²
            document.getElementById('resume-btn').addEventListener('click', () => {
                togglePause(); // åˆ‡æ›æš«åœç‹€æ…‹ï¼ˆæ¢å¾©éŠæˆ²ï¼‰
            });
            
            // é—œé–‰è–ç¶“ç¶“æ–‡ç•Œé¢æŒ‰éˆ•
            document.getElementById('close-bible-btn').addEventListener('click', () => {
                closeBibleOverlay(); // é—œé–‰è–ç¶“ç¶“æ–‡ç•Œé¢
            });
        }

        // ======================================================================
        // éŠæˆ²æ ¸å¿ƒåŠŸèƒ½
        // ======================================================================

        /**
         * é–‹å§‹æ–°éŠæˆ²
         * é‡ç½®æ‰€æœ‰éŠæˆ²ç‹€æ…‹ä¸¦ç”Ÿæˆæ–°çš„æ•¸ç¨è¬é¡Œ
         */
        function startNewGame() {
            // å¦‚æœéŠæˆ²æš«åœï¼Œå…ˆå–æ¶ˆæš«åœ
            if (isPaused) togglePause();
            
            // ç²å–é¸ä¸­çš„é›£åº¦
            const diff = document.getElementById('difficulty').value;
            
            // ç”Ÿæˆæ–°çš„æ•¸ç¨éŠæˆ²
            generateSudoku(diff);
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            gameOver = false; // éŠæˆ²æœªçµæŸ
            selectedCell = null; // æ²’æœ‰é¸ä¸­å–®å…ƒæ ¼
            errorCount = 0; // éŒ¯èª¤æ¬¡æ•¸æ­¸é›¶
            hintCount = 0; // æç¤ºä½¿ç”¨æ¬¡æ•¸æ­¸é›¶
            
            // é‡ç½®ç§˜å¯†ä»£ç¢¼ç›¸é—œç‹€æ…‹
            inputSequence = []; // æ¸…ç©ºè¼¸å…¥åºåˆ—
            lastInputTime = 0; // é‡ç½®æœ€å¾Œè¼¸å…¥æ™‚é–“
            isFreshGame = true; // æ¨™è¨˜ç‚ºå…¨æ–°éŠæˆ²
            
            // æ›´æ–°UI
            updateStats(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
            updateBoardUI(); // æ›´æ–°æ£‹ç›¤UI
            updateCounts(); // æ›´æ–°æ•¸å­—çµ±è¨ˆ
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
            
            // é–‹å§‹è¨ˆæ™‚
            startTimer(); // å•Ÿå‹•è¨ˆæ™‚å™¨
        }

        /**
         * å‰µå»ºæ•¸ç¨æ£‹ç›¤çš„HTMLçµæ§‹
         * ä½¿ç”¨9x9ç¶²æ ¼ä½ˆå±€ï¼Œä¸¦æ·»åŠ 3x3å®®æ ¼çš„ç²—é‚Šæ¡†
         * æ¯å€‹å–®å…ƒæ ¼åŒ…å«ä¸»æ•¸å­—é¡¯ç¤ºå€åŸŸå’Œç­†è¨˜ç¶²æ ¼
         */
        function createBoardHTML() {
            const boardEl = document.getElementById('sudoku-board'); // ç²å–æ£‹ç›¤å…ƒç´ 
            boardEl.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹
            
            // å‰µå»º9x9ç¶²æ ¼
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    const cell = document.createElement('div'); // å‰µå»ºå–®å…ƒæ ¼å…ƒç´ 
                    cell.className = 'cell'; // è¨­ç½®é¡å
                    cell.dataset.r = r; // å­˜å„²è¡Œç´¢å¼•ï¼Œç”¨æ–¼å¾ŒçºŒè­˜åˆ¥å–®å…ƒæ ¼ä½ç½®
                    cell.dataset.c = c; // å­˜å„²åˆ—ç´¢å¼•ï¼Œç”¨æ–¼å¾ŒçºŒè­˜åˆ¥å–®å…ƒæ ¼ä½ç½®
                    
                    // æ·»åŠ 3x3å®®æ ¼çš„ç²—é‚Šæ¡†ï¼Œå¢å¼·è¦–è¦ºçµæ§‹
                    if ((c + 1) % 3 === 0 && c !== 8) cell.classList.add('border-right'); // å³å´ç²—é‚Šæ¡†
                    if ((r + 1) % 3 === 0 && r !== 8) cell.classList.add('border-bottom'); // åº•éƒ¨ç²—é‚Šæ¡†
                    
                    // å‰µå»ºç­†è¨˜ç¶²æ ¼ï¼ˆç”¨æ–¼é¡¯ç¤ºå€™é¸æ•¸å­—ï¼‰
                    const notesDiv = document.createElement('div'); // å‰µå»ºç­†è¨˜å®¹å™¨
                    notesDiv.className = 'notes-grid'; // è¨­ç½®é¡å
                    for(let i = 1; i <= 9; i++) { // å‰µå»º1-9çš„ç­†è¨˜æ•¸å­—
                        const note = document.createElement('div'); // å‰µå»ºç­†è¨˜æ•¸å­—å…ƒç´ 
                        note.className = 'note-num'; // è¨­ç½®é¡å
                        note.dataset.num = i; // å­˜å„²æ•¸å­—å€¼ï¼Œç”¨æ–¼å¾ŒçºŒè­˜åˆ¥å’Œæ“ä½œ
                        notesDiv.appendChild(note); // æ·»åŠ åˆ°ç­†è¨˜å®¹å™¨
                    }
                    cell.appendChild(notesDiv); // å°‡ç­†è¨˜å®¹å™¨æ·»åŠ åˆ°å–®å…ƒæ ¼
                    
                    // å‰µå»ºä¸»æ•¸å­—é¡¯ç¤ºå€åŸŸ
                    const numSpan = document.createElement('span'); // å‰µå»ºæ•¸å­—é¡¯ç¤ºå…ƒç´ 
                    numSpan.className = 'main-num'; // è¨­ç½®é¡å
                    cell.appendChild(numSpan); // æ·»åŠ åˆ°å–®å…ƒæ ¼
                    
                    // æ·»åŠ é»æ“Šäº‹ä»¶ - é»æ“Šæ™‚é¸æ“‡è©²å–®å…ƒæ ¼
                    cell.addEventListener('click', () => selectCell(r, c)); // ç¶å®šé»æ“Šäº‹ä»¶
                    boardEl.appendChild(cell); // å°‡å–®å…ƒæ ¼æ·»åŠ åˆ°æ£‹ç›¤
                }
            }
        }

        /**
         * å‰µå»ºæ•¸å­—éµç›¤çš„HTMLçµæ§‹ - æ”¹ç‚ºé•·æ–¹å½¢æŒ‰éˆ•
         * åŒ…å«1-9çš„æ•¸å­—æŒ‰éˆ•ï¼Œç”¨æ–¼ç©å®¶è¼¸å…¥æ•¸å­—
         */
        function createKeypadHTML() {
            const keypad = document.getElementById('keypad'); // ç²å–æ•¸å­—éµç›¤å…ƒç´ 
            keypad.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹
            
            // å‰µå»º1-9çš„æ•¸å­—æŒ‰éˆ•
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('div'); // å‰µå»ºæŒ‰éˆ•å…ƒç´ 
                btn.className = 'numpad-btn'; // è¨­ç½®é¡å
                btn.id = `btn-num-${i}`; // è¨­ç½®ID
                btn.innerHTML = `<div class="num">${i}</div><div class="count">9</div>`; // è¨­ç½®HTMLå…§å®¹
                btn.addEventListener('click', () => handleInput(i)); // ç¶å®šé»æ“Šäº‹ä»¶
                keypad.appendChild(btn); // å°‡æŒ‰éˆ•æ·»åŠ åˆ°æ•¸å­—éµç›¤
            }
        }

        /**
         * é¸æ“‡å–®å…ƒæ ¼
         * @param {number} r - è¡Œç´¢å¼•
         * @param {number} c - åˆ—ç´¢å¼•
         * ç•¶ç©å®¶é»æ“Šå–®å…ƒæ ¼æ™‚ï¼Œå°‡å…¶è¨­ç½®ç‚ºç•¶å‰é¸ä¸­ç‹€æ…‹ä¸¦æ›´æ–°é«˜äº®é¡¯ç¤º
         */
        function selectCell(r, c) {
            // å¦‚æœéŠæˆ²çµæŸæˆ–æš«åœï¼Œä¸è™•ç†é¸æ“‡
            if (gameOver || isPaused) return;
            
            // è¨­ç½®ç•¶å‰é¸ä¸­çš„å–®å…ƒæ ¼
            selectedCell = { r, c }; // å­˜å„²é¸ä¸­å–®å…ƒæ ¼åº§æ¨™
            
            // æ›´æ–°é«˜äº®é¡¯ç¤º
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
            
            // æ’­æ”¾UIéŸ³æ•ˆ
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        /**
         * è™•ç†æ•¸å­—è¼¸å…¥
         * @param {number} num - è¼¸å…¥çš„æ•¸å­—ï¼ˆ1-9ï¼‰
         * æ ¹æ“šç•¶å‰é¸ä¸­çš„å–®å…ƒæ ¼å’Œè¼¸å…¥çš„æ•¸å­—ï¼Œæ›´æ–°éŠæˆ²ç‹€æ…‹
         */
        function handleInput(num) {
            // å¦‚æœéŠæˆ²çµæŸæˆ–éŠæˆ²æš«åœï¼Œä¸è™•ç†è¼¸å…¥
            if (gameOver || isPaused) return;
            
            // æª¢æŸ¥ç§˜å¯†ä»£ç¢¼ï¼ˆç„¡è«–æ˜¯å¦æœ‰é¸ä¸­å–®å…ƒæ ¼éƒ½æª¢æŸ¥ï¼‰
            checkSecretCode(num); // æª¢æŸ¥è¼¸å…¥çš„æ•¸å­—æ˜¯å¦åŒ¹é…ç§˜å¯†ä»£ç¢¼
            
            // å¦‚æœæ²’æœ‰é¸ä¸­å–®å…ƒæ ¼ï¼Œåªæª¢æŸ¥ç§˜å¯†ä»£ç¢¼ï¼Œä¸é€²è¡Œæ•¸ç¨è¼¸å…¥
            if (!selectedCell) return;
            
            const { r, c } = selectedCell; // è§£æ§‹é¸ä¸­å–®å…ƒæ ¼åº§æ¨™
            
            // å¦‚æœå–®å…ƒæ ¼æ˜¯åˆå§‹ç·šç´¢æˆ–å·²ç¶“æ­£ç¢ºå¡«å¯«ï¼Œä¸å…è¨±ä¿®æ”¹
            if (initial[r][c] !== 0 || (board[r][c] !== 0 && board[r][c] === solution[r][c])) return;
            
            const cellDiv = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
            
            // æª¢æŸ¥ç­”æ¡ˆæ˜¯å¦æ­£ç¢º
            if (num === solution[r][c]) {
                // æ­£ç¢ºç­”æ¡ˆ
                board[r][c] = num; // æ›´æ–°éŠæˆ²ç›¤é¢
                playSound('correct'); // æ’­æ”¾æ­£ç¢ºéŸ³æ•ˆ
                updateBoardUI(); // æ›´æ–°æ£‹ç›¤UI
                updateCounts(); // æ›´æ–°æ•¸å­—çµ±è¨ˆ
                updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
                checkWin(); // æª¢æŸ¥æ˜¯å¦å®ŒæˆéŠæˆ²
                
                // æ¨™è¨˜éŠæˆ²å·²ç¶“æœ‰è¼¸å…¥ï¼Œä¸å†æ¥å—ç§˜å¯†ä»£ç¢¼
                isFreshGame = false; // è¨­ç½®ç‚ºéå…¨æ–°éŠæˆ²
            } else {
                // éŒ¯èª¤ç­”æ¡ˆ
                playSound('error'); // æ’­æ”¾éŒ¯èª¤éŸ³æ•ˆ
                errorCount++; // å¢åŠ éŒ¯èª¤è¨ˆæ•¸
                updateStats(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
                
                // é¡¯ç¤ºéŒ¯èª¤å‹•ç•«
                cellDiv.querySelector('.main-num').innerText = num; // é¡¯ç¤ºè¼¸å…¥çš„æ•¸å­—
                cellDiv.classList.add('error'); // æ·»åŠ éŒ¯èª¤é¡
                cellDiv.classList.add('filled'); // æ·»åŠ å·²å¡«å……é¡
                
                // 500æ¯«ç§’å¾Œæ¢å¾©æ­£å¸¸é¡¯ç¤º
                setTimeout(() => {
                    cellDiv.classList.remove('error'); // ç§»é™¤éŒ¯èª¤é¡
                    cellDiv.querySelector('.main-num').innerText = board[r][c] === 0 ? '' : board[r][c]; // æ¢å¾©åŸå§‹é¡¯ç¤º
                    cellDiv.classList.remove('filled'); // ç§»é™¤å·²å¡«å……é¡
                    if (notesEnabled) updateNotes(); // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œæ›´æ–°ç­†è¨˜
                }, 500); // 500æ¯«ç§’å¾ŒåŸ·è¡Œ
                
                // æ¨™è¨˜éŠæˆ²å·²ç¶“æœ‰è¼¸å…¥ï¼Œä¸å†æ¥å—ç§˜å¯†ä»£ç¢¼
                isFreshGame = false; // è¨­ç½®ç‚ºéå…¨æ–°éŠæˆ²
            }
        }

        /**
         * æª¢æŸ¥ç§˜å¯†ä»£ç¢¼è¼¸å…¥
         * @param {number} num - è¼¸å…¥çš„æ•¸å­—
         * æª¢æŸ¥ç©å®¶è¼¸å…¥çš„æ•¸å­—åºåˆ—æ˜¯å¦åŒ¹é…é è¨­çš„ç§˜å¯†ä»£ç¢¼
         * åªæœ‰åœ¨éŠæˆ²å‰›é–‹å§‹ä¸”æ²’æœ‰ä»»ä½•æ•¸ç¨è¼¸å…¥æ™‚æ‰æœ‰æ•ˆ
         */
        function checkSecretCode(num) {
            // å¦‚æœéŠæˆ²å·²ç¶“æœ‰è¼¸å…¥ï¼ˆéå…¨æ–°éŠæˆ²ï¼‰ï¼Œä¸æª¢æŸ¥ç§˜å¯†ä»£ç¢¼
            if (!isFreshGame) return;
            
            const currentTime = Date.now(); // ç²å–ç•¶å‰æ™‚é–“
            
            // å¦‚æœå…©æ¬¡è¼¸å…¥é–“éš”è¶…é3ç§’ï¼Œé‡ç½®åºåˆ—
            if (currentTime - lastInputTime > 3000) { // å¦‚æœé–“éš”è¶…é3ç§’
                inputSequence = []; // æ¸…ç©ºè¼¸å…¥åºåˆ—
            }
            
            // è¨˜éŒ„ç•¶å‰è¼¸å…¥å’Œæ™‚é–“
            inputSequence.push(num); // å°‡è¼¸å…¥çš„æ•¸å­—æ·»åŠ åˆ°åºåˆ—
            lastInputTime = currentTime; // æ›´æ–°æœ€å¾Œè¼¸å…¥æ™‚é–“
            
            // å¦‚æœåºåˆ—é•·åº¦è¶…éç§˜å¯†ä»£ç¢¼é•·åº¦ï¼Œç§»é™¤æœ€æ—©çš„è¼¸å…¥
            if (inputSequence.length > secretCode.length) { // å¦‚æœåºåˆ—é•·åº¦è¶…éç§˜å¯†ä»£ç¢¼é•·åº¦
                inputSequence.shift(); // ç§»é™¤åºåˆ—ä¸­çš„ç¬¬ä¸€å€‹å…ƒç´ 
            }
            
            // æª¢æŸ¥åºåˆ—æ˜¯å¦åŒ¹é…ç§˜å¯†ä»£ç¢¼
            if (inputSequence.length === secretCode.length) { // å¦‚æœåºåˆ—é•·åº¦ç­‰æ–¼ç§˜å¯†ä»£ç¢¼é•·åº¦
                let isMatch = true; // åŒ¹é…æ¨™èªŒ
                
                // é€å€‹æ¯”è¼ƒåºåˆ—ä¸­çš„æ•¸å­—
                for (let i = 0; i < secretCode.length; i++) { // éæ­·åºåˆ—ä¸­çš„æ¯å€‹æ•¸å­—
                    if (inputSequence[i] !== secretCode[i]) { // å¦‚æœæ•¸å­—ä¸åŒ¹é…
                        isMatch = false; // è¨­ç½®ç‚ºä¸åŒ¹é…
                        break; // è·³å‡ºå¾ªç’°
                    }
                }
                
                // å¦‚æœåŒ¹é…æˆåŠŸï¼Œé¡¯ç¤ºè–ç¶“ç¶“æ–‡
                if (isMatch) { // å¦‚æœåºåˆ—åŒ¹é…ç§˜å¯†ä»£ç¢¼
                    showBibleOverlay(); // é¡¯ç¤ºè–ç¶“ç¶“æ–‡ç•Œé¢
                    inputSequence = []; // é‡ç½®è¼¸å…¥åºåˆ—
                    isFreshGame = false; // æ¨™è¨˜éŠæˆ²å·²ç¶“æœ‰è¼¸å…¥ï¼Œä¸å†æ¥å—ç§˜å¯†ä»£ç¢¼
                }
            }
        }

        /**
         * é¡¯ç¤ºè–ç¶“ç¶“æ–‡ç•Œé¢
         * é¡¯ç¤ºè©©ç¯‡23ç¯‡çš„å®Œæ•´å…§å®¹
         */
        function showBibleOverlay() {
            document.getElementById('bible-overlay').style.display = 'flex'; // é¡¯ç¤ºè–ç¶“ç¶“æ–‡ç•Œé¢
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        /**
         * é—œé–‰è–ç¶“ç¶“æ–‡ç•Œé¢
         * éš±è—è–ç¶“ç¶“æ–‡ç•Œé¢ï¼Œè¿”å›éŠæˆ²
         */
        function closeBibleOverlay() {
            document.getElementById('bible-overlay').style.display = 'none'; // éš±è—è–ç¶“ç¶“æ–‡ç•Œé¢
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        /**
         * åŠ è¼‰è–ç¶“ç¶“æ–‡å…§å®¹
         * å°‡è©©ç¯‡23ç¯‡çš„å…§å®¹å¡«å……åˆ°è–ç¶“ç¶“æ–‡ç•Œé¢
         */
        function loadBibleContent() {
            const bibleContent = document.getElementById('bible-content'); // ç²å–è–ç¶“ç¶“æ–‡å…§å®¹å…ƒç´ 
            
            // è©©ç¯‡23ç¯‡å…¨æ–‡ï¼ˆä½¿ç”¨å‡¸æ’æ’ç‰ˆï¼‰
            const psalms23 = [
                { number: 1, text: "è€¶å’Œè¯æ˜¯æˆ‘çš„ç‰§è€…ï¼Œæˆ‘å¿…ä¸è‡´ç¼ºä¹ã€‚" },
                { number: 2, text: "ä»–ä½¿æˆ‘èººè‡¥åœ¨é’è‰åœ°ä¸Šï¼Œé ˜æˆ‘åœ¨å¯å®‰æ­‡çš„æ°´é‚Šã€‚" },
                { number: 3, text: "ä»–ä½¿æˆ‘çš„éˆé­‚ç”¦é†’ï¼Œç‚ºè‡ªå·±çš„åå¼•å°æˆ‘èµ°ç¾©è·¯ã€‚" },
                { number: 4, text: "æˆ‘é›–ç„¶è¡Œéæ­»è”­çš„å¹½è°·ï¼Œä¹Ÿä¸æ€•é­å®³ï¼Œå› ç‚ºä½ èˆ‡æˆ‘åŒåœ¨ï¼›ä½ çš„æ–ï¼Œä½ çš„ç«¿ï¼Œéƒ½å®‰æ…°æˆ‘ã€‚" },
                { number: 5, text: "åœ¨æˆ‘æ•µäººé¢å‰ï¼Œä½ ç‚ºæˆ‘æ“ºè¨­ç­µå¸­ï¼›ä½ ç”¨æ²¹è†äº†æˆ‘çš„é ­ï¼Œä½¿æˆ‘çš„ç¦æ¯æ»¿æº¢ã€‚" },
                { number: 6, text: "æˆ‘ä¸€ç”Ÿä¸€ä¸–å¿…æœ‰æ©æƒ æ…ˆæ„›éš¨è‘—æˆ‘ï¼›æˆ‘ä¸”è¦ä½åœ¨è€¶å’Œè¯çš„æ®¿ä¸­ï¼Œç›´åˆ°æ°¸é ã€‚" }
            ];
            
            // æ¸…ç©ºç¾æœ‰å…§å®¹
            bibleContent.innerHTML = '';
            
            // å°‡æ¯ç¯€ç¶“æ–‡æ·»åŠ åˆ°å…§å®¹ä¸­
            psalms23.forEach(verse => { // éæ­·æ¯ç¯€ç¶“æ–‡
                const verseElement = document.createElement('div'); // å‰µå»ºç¶“æ–‡å…ƒç´ 
                verseElement.className = 'bible-verse'; // è¨­ç½®é¡å
                
                // å‰µå»ºç¯€è™Ÿå…ƒç´ 
                const verseNumber = document.createElement('span'); // å‰µå»ºç¯€è™Ÿå…ƒç´ 
                verseNumber.className = 'verse-number'; // è¨­ç½®é¡å
                verseNumber.textContent = verse.number + '.'; // è¨­ç½®ç¯€è™Ÿå…§å®¹
                
                // å‰µå»ºç¶“æ–‡æ–‡æœ¬å…ƒç´ 
                const verseText = document.createElement('span'); // å‰µå»ºç¶“æ–‡æ–‡æœ¬å…ƒç´ 
                verseText.textContent = verse.text; // è¨­ç½®ç¶“æ–‡æ–‡æœ¬å…§å®¹
                
                // å°‡ç¯€è™Ÿå’Œç¶“æ–‡æ–‡æœ¬æ·»åŠ åˆ°ç¶“æ–‡å…ƒç´ 
                verseElement.appendChild(verseNumber); // æ·»åŠ ç¯€è™Ÿ
                verseElement.appendChild(verseText); // æ·»åŠ ç¶“æ–‡æ–‡æœ¬
                
                bibleContent.appendChild(verseElement); // å°‡ç¶“æ–‡å…ƒç´ æ·»åŠ åˆ°å…§å®¹å®¹å™¨
            });
        }

        /**
         * æ›´æ–°çµ±è¨ˆé¡¯ç¤º
         * æ›´æ–°éŒ¯èª¤æ¬¡æ•¸å’Œæç¤ºä½¿ç”¨æ¬¡æ•¸çš„é¡¯ç¤º
         */
        function updateStats() {
            // ä½¿ç”¨padStartç¢ºä¿å…©ä½æ•¸é¡¯ç¤º
            document.getElementById('error-stat').innerText = errorCount.toString().padStart(2, '0'); // æ›´æ–°éŒ¯èª¤æ¬¡æ•¸é¡¯ç¤º
            document.getElementById('hint-stat').innerText = hintCount.toString().padStart(2, '0'); // æ›´æ–°æç¤ºæ¬¡æ•¸é¡¯ç¤º
            
            // åŒæ™‚æ›´æ–°å‹åˆ©ç•Œé¢çš„çµ±è¨ˆé¡¯ç¤º
            document.getElementById('victory-stats').innerText = `Errors: ${errorCount.toString().padStart(2, '0')}, Hints: ${hintCount.toString().padStart(2, '0')}`; // æ›´æ–°å‹åˆ©ç•Œé¢çµ±è¨ˆé¡¯ç¤º
        }

        /**
         * é–‹å§‹è¨ˆæ™‚å™¨
         * åˆå§‹åŒ–è¨ˆæ™‚å™¨ä¸¦æ¯ç§’æ›´æ–°æ™‚é–“é¡¯ç¤º
         */
        function startTimer() {
            stopTimer(); // åœæ­¢ç¾æœ‰è¨ˆæ™‚å™¨
            timeElapsed = 0; // é‡ç½®å·²è€—è²»æ™‚é–“
            isPaused = false; // å–æ¶ˆæš«åœç‹€æ…‹
            updateTimerDisplay(); // æ›´æ–°æ™‚é–“é¡¯ç¤º
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡æ™‚é–“é¡¯ç¤º
            timerInterval = setInterval(() => {
                if (!isPaused && !gameOver) { // å¦‚æœéŠæˆ²æœªæš«åœä¸”æœªçµæŸ
                    timeElapsed++; // å¢åŠ å·²è€—è²»æ™‚é–“
                    updateTimerDisplay(); // æ›´æ–°æ™‚é–“é¡¯ç¤º
                }
            }, 1000); // æ¯ç§’åŸ·è¡Œä¸€æ¬¡
        }

        /**
         * åœæ­¢è¨ˆæ™‚å™¨
         * æ¸…é™¤è¨ˆæ™‚å™¨é–“éš”ï¼Œåœæ­¢è¨ˆæ™‚
         */
        function stopTimer() {
            if (timerInterval) { // å¦‚æœè¨ˆæ™‚å™¨é–“éš”å­˜åœ¨
                clearInterval(timerInterval); // æ¸…é™¤è¨ˆæ™‚å™¨é–“éš”
                timerInterval = null; // é‡ç½®è¨ˆæ™‚å™¨é–“éš”è®Šæ•¸
            }
        }

        /**
         * æ›´æ–°æ™‚é–“é¡¯ç¤º
         * å°‡ç§’æ•¸è½‰æ›ç‚ºæ™‚:åˆ†:ç§’æ ¼å¼ä¸¦æ›´æ–°é¡¯ç¤º
         * @returns {string} æ ¼å¼åŒ–å¾Œçš„æ™‚é–“å­—ç¬¦ä¸²
         */
        function updateTimerDisplay() {
            const hours = Math.floor(timeElapsed / 3600); // è¨ˆç®—å°æ™‚æ•¸
            const minutes = Math.floor((timeElapsed % 3600) / 60); // è¨ˆç®—åˆ†é˜æ•¸
            const seconds = timeElapsed % 60; // è¨ˆç®—ç§’æ•¸
            const text = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`; // æ ¼å¼åŒ–æ™‚é–“å­—ç¬¦ä¸²
            document.getElementById('timer-display').innerText = text; // æ›´æ–°æ™‚é–“é¡¯ç¤º
            // åŒæ™‚æ›´æ–°å‹åˆ©ç•Œé¢çš„æ™‚é–“é¡¯ç¤º
            document.getElementById('victory-time-text').innerText = `Time: ${text}`; // æ›´æ–°å‹åˆ©ç•Œé¢æ™‚é–“é¡¯ç¤º
            return text; // è¿”å›æ ¼å¼åŒ–å¾Œçš„æ™‚é–“å­—ç¬¦ä¸²
        }

        /**
         * åˆ‡æ›æš«åœç‹€æ…‹
         * æš«åœæˆ–æ¢å¾©éŠæˆ²
         */
        function togglePause() {
            isPaused = !isPaused; // åˆ‡æ›æš«åœç‹€æ…‹
            
            if (isPaused) {
                // æš«åœéŠæˆ²
                document.getElementById('pause-overlay').style.display = 'flex'; // é¡¯ç¤ºæš«åœç•Œé¢
                document.getElementById('sudoku-board').classList.add('blurred'); // æ·»åŠ æ¨¡ç³Šæ•ˆæœ
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
            } else {
                // æ¢å¾©éŠæˆ²
                document.getElementById('pause-overlay').style.display = 'none'; // éš±è—æš«åœç•Œé¢
                document.getElementById('sudoku-board').classList.remove('blurred'); // ç§»é™¤æ¨¡ç³Šæ•ˆæœ
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
            }
        }

        // ======================================================================
        // æ•¸ç¨ç”Ÿæˆèˆ‡é©—è­‰ç®—æ³•
        // ======================================================================

        /**
         * æ ¹æ“šé›£åº¦ç”Ÿæˆæ•¸ç¨éŠæˆ²
         * @param {string} difficulty - é›£åº¦ç´šåˆ¥ï¼š'Beginner', 'Easy', 'Medium', 'Hard', 'Expert'
         * ä½¿ç”¨å›æº¯ç®—æ³•ç”Ÿæˆå®Œæ•´è§£ç­”ï¼Œç„¶å¾Œæ ¹æ“šé›£åº¦ç§»é™¤ä¸€å®šæ•¸é‡çš„æ•¸å­—
         */
        function generateSudoku(difficulty) {
            // åˆå§‹åŒ–ç©ºç™½ç›¤é¢
            board = Array.from({ length: 9 }, () => Array(9).fill(0)); // å‰µå»º9x9çš„äºŒç¶­æ•¸çµ„ï¼Œå…¨éƒ¨å¡«å……0
            
            // å…ˆå¡«å……å°è§’ç·šçš„ä¸‰å€‹3x3å®®æ ¼ï¼ˆé€™æ¨£å¯ä»¥ç¢ºä¿ä¸è¡çªï¼‰
            fillDiagonal(); // å¡«å……å°è§’ç·šå®®æ ¼
            
            // ä½¿ç”¨å›æº¯ç®—æ³•è§£æ±ºå®Œæ•´çš„æ•¸ç¨
            solveSudoku(board); // è§£æ±ºæ•¸ç¨
            
            // ä¿å­˜å®Œæ•´è§£ç­”
            solution = JSON.parse(JSON.stringify(board)); // æ·±æ‹·è²è§£ç­”
            
            // æ ¹æ“šé›£åº¦æ±ºå®šç§»é™¤å¤šå°‘æ•¸å­—ï¼ˆæ•¸å­—è¶Šå°‘é›£åº¦è¶Šé«˜ï¼‰
            let attempts = 0; // ç§»é™¤æ•¸å­—å˜—è©¦æ¬¡æ•¸
            switch(difficulty) {
                case 'Beginner': attempts = 20; break; // å…¥é–€ - ç§»é™¤20å€‹æ•¸å­—
                case 'Easy': attempts = 30; break;     // ç°¡å–® - ç§»é™¤30å€‹æ•¸å­—
                case 'Medium': attempts = 40; break;   // ä¸­ç­‰ - ç§»é™¤40å€‹æ•¸å­—
                case 'Hard': attempts = 50; break;     // å›°é›£ - ç§»é™¤50å€‹æ•¸å­—
                case 'Expert': attempts = 58; break;   // å°ˆå®¶ - ç§»é™¤58å€‹æ•¸å­—
            }
            
            // ä¿å­˜åˆå§‹ç›¤é¢ï¼ˆåŒ…å«ç·šç´¢æ•¸å­—ï¼‰
            initial = JSON.parse(JSON.stringify(solution)); // æ·±æ‹·è²åˆå§‹ç›¤é¢
            
            // é‡ç½®ç©å®¶ç›¤é¢
            board = Array.from({ length: 9 }, () => Array(9).fill(0)); // å‰µå»ºç©ºç™½ç©å®¶ç›¤é¢
            
            // éš¨æ©Ÿç§»é™¤æŒ‡å®šæ•¸é‡çš„æ•¸å­—
            let removed = 0; // å·²ç§»é™¤æ•¸å­—è¨ˆæ•¸
            while (removed < attempts) { // å¾ªç’°ç›´åˆ°ç§»é™¤è¶³å¤ æ•¸å­—
                let row = Math.floor(Math.random() * 9); // éš¨æ©Ÿè¡Œç´¢å¼•
                let col = Math.floor(Math.random() * 9); // éš¨æ©Ÿåˆ—ç´¢å¼•
                
                // å¦‚æœè©²ä½ç½®æœ‰æ•¸å­—ï¼Œç§»é™¤å®ƒ
                if (initial[row][col] !== 0) { // å¦‚æœè©²ä½ç½®æœ‰æ•¸å­—
                    initial[row][col] = 0; // ç§»é™¤æ•¸å­—
                    removed++; // å¢åŠ å·²ç§»é™¤è¨ˆæ•¸
                }
            }
        }

        /**
         * å¡«å……å°è§’ç·šçš„ä¸‰å€‹3x3å®®æ ¼
         * é€™ä¸‰å€‹å®®æ ¼äº’ä¸å½±éŸ¿ï¼Œå¯ä»¥ç¨ç«‹å¡«å……ï¼Œç¢ºä¿åˆå§‹ç‹€æ…‹æœ‰æ•ˆ
         */
        function fillDiagonal() {
            for (let i = 0; i < 9; i += 3) { // éæ­·å°è§’ç·šçš„ä¸‰å€‹å®®æ ¼
                fillBox(i, i); // å¡«å……æ¯å€‹3x3å®®æ ¼
            }
        }

        /**
         * å¡«å……æŒ‡å®šçš„3x3å®®æ ¼
         * @param {number} row - å®®æ ¼èµ·å§‹è¡Œ
         * @param {number} col - å®®æ ¼èµ·å§‹åˆ—
         * éš¨æ©Ÿç”Ÿæˆæ•¸å­—å¡«å……3x3å®®æ ¼ï¼Œç¢ºä¿å®®æ ¼å…§æ•¸å­—ä¸é‡è¤‡
         */
        function fillBox(row, col) {
            let num; // æ•¸å­—è®Šæ•¸
            for (let i = 0; i < 3; i++) { // éæ­·å®®æ ¼çš„è¡Œ
                for (let j = 0; j < 3; j++) { // éæ­·å®®æ ¼çš„åˆ—
                    // éš¨æ©Ÿç”Ÿæˆæ•¸å­—ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€å€‹å¯ç”¨çš„
                    do {
                        num = Math.floor(Math.random() * 9) + 1; // ç”Ÿæˆ1-9çš„éš¨æ©Ÿæ•¸å­—
                    } while (!isSafeInBox(row, col, num)); // æª¢æŸ¥æ•¸å­—æ˜¯å¦å¯ç”¨
                    
                    board[row + i][col + j] = num; // æ”¾ç½®æ•¸å­—åˆ°ç›¤é¢
                }
            }
        }

        /**
         * æª¢æŸ¥æ•¸å­—åœ¨æŒ‡å®š3x3å®®æ ¼ä¸­æ˜¯å¦å®‰å…¨ï¼ˆä¸é‡è¤‡ï¼‰
         * @param {number} rowStart - å®®æ ¼èµ·å§‹è¡Œ
         * @param {number} colStart - å®®æ ¼èµ·å§‹åˆ—
         * @param {number} num - è¦æª¢æŸ¥çš„æ•¸å­—
         * @returns {boolean} æ˜¯å¦å®‰å…¨
         */
        function isSafeInBox(rowStart, colStart, num) {
            for (let i = 0; i < 3; i++) { // éæ­·å®®æ ¼çš„è¡Œ
                for (let j = 0; j < 3; j++) { // éæ­·å®®æ ¼çš„åˆ—
                    if (board[rowStart + i][colStart + j] === num) return false; // å¦‚æœæ•¸å­—å·²å­˜åœ¨ï¼Œè¿”å›ä¸å®‰å…¨
                }
            }
            return true; // æ•¸å­—å®‰å…¨ï¼Œè¿”å›true
        }

        /**
         * ä½¿ç”¨å›æº¯ç®—æ³•è§£æ±ºæ•¸ç¨
         * @param {Array} grid - æ•¸ç¨ç›¤é¢
         * @returns {boolean} æ˜¯å¦æˆåŠŸè§£æ±º
         * é€™æ˜¯ç¶“å…¸çš„å›æº¯ç®—æ³•å¯¦ç¾ï¼Œç”¨æ–¼ç”Ÿæˆæ•¸ç¨è§£ç­”
         */
        function solveSudoku(grid) {
            for (let row = 0; row < 9; row++) { // éæ­·æ¯ä¸€è¡Œ
                for (let col = 0; col < 9; col++) { // éæ­·æ¯ä¸€åˆ—
                    // æ‰¾åˆ°ç©ºç™½å–®å…ƒæ ¼
                    if (grid[row][col] === 0) { // å¦‚æœå–®å…ƒæ ¼ç‚ºç©ºç™½
                        // å˜—è©¦1-9çš„æ•¸å­—
                        for (let num = 1; num <= 9; num++) { // å˜—è©¦æ•¸å­—1-9
                            // æª¢æŸ¥æ•¸å­—æ˜¯å¦å®‰å…¨
                            if (isSafe(grid, row, col, num)) { // å¦‚æœæ•¸å­—å®‰å…¨
                                // æ”¾ç½®æ•¸å­—
                                grid[row][col] = num; // æ”¾ç½®æ•¸å­—åˆ°ç›¤é¢
                                
                                // éæ­¸å˜—è©¦è§£æ±ºå‰©ä¸‹çš„ç›¤é¢
                                if (solveSudoku(grid)) return true; // å¦‚æœéæ­¸è§£æ±ºæˆåŠŸï¼Œè¿”å›true
                                
                                // å¦‚æœéæ­¸å¤±æ•—ï¼Œå›æº¯ï¼ˆé‡ç½®å–®å…ƒæ ¼ï¼‰
                                grid[row][col] = 0; // é‡ç½®å–®å…ƒæ ¼
                            }
                        }
                        // å¦‚æœæ‰€æœ‰æ•¸å­—éƒ½å˜—è©¦éä½†éƒ½ä¸è¡Œï¼Œè¿”å›å¤±æ•—
                        return false; // è¿”å›å¤±æ•—
                    }
                }
            }
            // æ‰€æœ‰å–®å…ƒæ ¼éƒ½å·²å¡«æ»¿ï¼Œè§£æ±ºæˆåŠŸ
            return true; // è¿”å›æˆåŠŸ
        }

        /**
         * æª¢æŸ¥æ•¸å­—åœ¨æŒ‡å®šä½ç½®æ˜¯å¦å®‰å…¨
         * @param {Array} grid - æ•¸ç¨ç›¤é¢
         * @param {number} row - è¡Œç´¢å¼•
         * @param {number} col - åˆ—ç´¢å¼•
         * @param {number} num - è¦æª¢æŸ¥çš„æ•¸å­—
         * @returns {boolean} æ˜¯å¦å®‰å…¨
         * æª¢æŸ¥è¡Œã€åˆ—å’Œ3x3å®®æ ¼ä¸­æ˜¯å¦æœ‰é‡è¤‡æ•¸å­—
         */
        function isSafe(grid, row, col, num) {
            // æª¢æŸ¥è¡Œå’Œåˆ—
            for (let x = 0; x < 9; x++) { // éæ­·è¡Œå’Œåˆ—
                if (grid[row][x] === num || grid[x][col] === num) return false; // å¦‚æœè¡Œæˆ–åˆ—ä¸­æœ‰é‡è¤‡æ•¸å­—ï¼Œè¿”å›ä¸å®‰å…¨
            }
            
            // æª¢æŸ¥3x3å®®æ ¼
            let startRow = row - row % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹è¡Œ
            let startCol = col - col % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹åˆ—
            for (let i = 0; i < 3; i++) { // éæ­·å®®æ ¼çš„è¡Œ
                for (let j = 0; j < 3; j++) { // éæ­·å®®æ ¼çš„åˆ—
                    if (grid[i + startRow][j + startCol] === num) return false; // å¦‚æœå®®æ ¼ä¸­æœ‰é‡è¤‡æ•¸å­—ï¼Œè¿”å›ä¸å®‰å…¨
                }
            }
            return true; // æ•¸å­—å®‰å…¨ï¼Œè¿”å›true
        }

        /**
         * ä½¿ç”¨æç¤ºåŠŸèƒ½ï¼ˆè‡ªå‹•å¡«å…¥ä¸€å€‹æ­£ç¢ºæ•¸å­—ï¼‰
         * éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç©ºç™½å–®å…ƒæ ¼ä¸¦å¡«å…¥æ­£ç¢ºç­”æ¡ˆ
         */
        function useHint() {
            // å¦‚æœéŠæˆ²çµæŸæˆ–æš«åœï¼Œä¸æä¾›æç¤º
            if (gameOver || isPaused) return;
            
            // æ”¶é›†æ‰€æœ‰ç©ºç™½å–®å…ƒæ ¼
            const emptyCells = []; // ç©ºç™½å–®å…ƒæ ¼æ•¸çµ„
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    if (board[r][c] === 0 && initial[r][c] === 0) { // å¦‚æœå–®å…ƒæ ¼æ˜¯ç©ºç™½ä¸”ä¸æ˜¯åˆå§‹ç·šç´¢
                        emptyCells.push({r, c}); // æ·»åŠ åˆ°ç©ºç™½å–®å…ƒæ ¼æ•¸çµ„
                    }
                }
            }
            
            // å¦‚æœæ²’æœ‰ç©ºç™½å–®å…ƒæ ¼ï¼Œç›´æ¥è¿”å›
            if (emptyCells.length === 0) return;
            
            // å¢åŠ æç¤ºè¨ˆæ•¸ä¸¦æ›´æ–°é¡¯ç¤º
            hintCount++; // å¢åŠ æç¤ºè¨ˆæ•¸
            updateStats(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
            
            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç©ºç™½å–®å…ƒæ ¼
            const { r, c } = emptyCells[Math.floor(Math.random() * emptyCells.length)]; // éš¨æ©Ÿé¸æ“‡ç©ºç™½å–®å…ƒæ ¼
            
            // å¡«å…¥æ­£ç¢ºç­”æ¡ˆ
            board[r][c] = solution[r][c]; // å¡«å…¥æ­£ç¢ºç­”æ¡ˆ
            updateBoardUI(); // æ›´æ–°æ£‹ç›¤UI
            
            // æ·»åŠ æç¤ºå‹•ç•«æ•ˆæœ
            const cellDiv = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
            cellDiv.classList.add('hinting'); // æ·»åŠ æç¤ºå‹•ç•«é¡
            setTimeout(() => {
                if (cellDiv) cellDiv.classList.remove('hinting'); // ç§»é™¤æç¤ºå‹•ç•«é¡
            }, 2000); // 2ç§’å¾ŒåŸ·è¡Œ
            
            // æ’­æ”¾æç¤ºéŸ³æ•ˆ
            playSound('hint'); // æ’­æ”¾æç¤ºéŸ³æ•ˆ
            
            // æ›´æ–°UI
            updateCounts(); // æ›´æ–°æ•¸å­—çµ±è¨ˆ
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
            
            // æª¢æŸ¥æ˜¯å¦å®ŒæˆéŠæˆ²
            checkWin(); // æª¢æŸ¥æ˜¯å¦å®ŒæˆéŠæˆ²
            
            // æ¨™è¨˜éŠæˆ²å·²ç¶“æœ‰è¼¸å…¥ï¼Œä¸å†æ¥å—ç§˜å¯†ä»£ç¢¼
            isFreshGame = false; // è¨­ç½®ç‚ºéå…¨æ–°éŠæˆ²
        }

        /**
         * ç²å–æŒ‡å®šå–®å…ƒæ ¼çš„DOMå…ƒç´ 
         * @param {number} r - è¡Œç´¢å¼•
         * @param {number} c - åˆ—ç´¢å¼•
         * @returns {HTMLElement} å–®å…ƒæ ¼DOMå…ƒç´ 
         */
        function getCellDiv(r, c) {
            return document.querySelector(`.cell[data-r='${r}'][data-c='${c}']`); // ä½¿ç”¨å±¬æ€§é¸æ“‡å™¨ç²å–å–®å…ƒæ ¼
        }

        /**
         * æ›´æ–°æ•¸ç¨ç›¤é¢UI
         * æ ¹æ“šç•¶å‰éŠæˆ²ç‹€æ…‹æ›´æ–°æ‰€æœ‰å–®å…ƒæ ¼çš„é¡¯ç¤º
         */
        function updateBoardUI() {
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    const cell = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
                    
                    // ç²å–å–®å…ƒæ ¼çš„å€¼ï¼ˆç©å®¶è¼¸å…¥æˆ–åˆå§‹ç·šç´¢ï¼‰
                    const val = board[r][c] !== 0 ? board[r][c] : initial[r][c]; // å„ªå…ˆä½¿ç”¨ç©å®¶è¼¸å…¥ï¼Œå¦å‰‡ä½¿ç”¨åˆå§‹ç·šç´¢
                    
                    // æ›´æ–°ä¸»æ•¸å­—é¡¯ç¤º
                    cell.querySelector('.main-num').innerText = val === 0 ? '' : val; // å¦‚æœå€¼ç‚º0å‰‡é¡¯ç¤ºç©ºå­—ç¬¦ä¸²ï¼Œå¦å‰‡é¡¯ç¤ºæ•¸å­—
                    
                    // é‡ç½®å–®å…ƒæ ¼é¡
                    cell.className = 'cell'; // é‡ç½®é¡å
                    
                    // æ·»åŠ 3x3å®®æ ¼é‚Šæ¡†
                    if ((c + 1) % 3 === 0 && c !== 8) cell.classList.add('border-right'); // å³å´ç²—é‚Šæ¡†
                    if ((r + 1) % 3 === 0 && r !== 8) cell.classList.add('border-bottom'); // åº•éƒ¨ç²—é‚Šæ¡†
                    
                    // è¨­ç½®å–®å…ƒæ ¼é¡å‹
                    if (initial[r][c] !== 0) { // å¦‚æœæ˜¯åˆå§‹ç·šç´¢
                        cell.classList.add('clue'); // æ·»åŠ ç·šç´¢é¡
                    } else if (board[r][c] !== 0) { // å¦‚æœæ˜¯ç©å®¶å¡«å¯«çš„æ•¸å­—
                        cell.classList.add('filled'); // æ·»åŠ å·²å¡«å……é¡
                    }
                }
            }
            
            // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œæ›´æ–°ç­†è¨˜é¡¯ç¤º
            if (notesEnabled) updateNotes(); // æ›´æ–°ç­†è¨˜é¡¯ç¤º
            else clearNotes(); // æ¸…é™¤ç­†è¨˜é¡¯ç¤º
        }

        /**
         * åˆ‡æ›ç­†è¨˜æ¨¡å¼
         * ç­†è¨˜æ¨¡å¼å…è¨±ç©å®¶åœ¨å–®å…ƒæ ¼ä¸­æ¨™è¨˜å€™é¸æ•¸å­—
         */
        function toggleNotes() {
            if (isPaused) return; // å¦‚æœéŠæˆ²æš«åœï¼Œä¸è™•ç†
            
            // åˆ‡æ›ç­†è¨˜æ¨¡å¼ç‹€æ…‹
            notesEnabled = !notesEnabled; // åˆ‡æ›ç­†è¨˜æ¨¡å¼ç‹€æ…‹
            
            // æ›´æ–°æŒ‰éˆ•é¡è‰²
            const notesBtn = document.getElementById('btn-notes'); // ç²å–ç­†è¨˜æŒ‰éˆ•
            if (notesEnabled) { // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨
                notesBtn.classList.add('btn-on'); // æ·»åŠ é–‹å•Ÿç‹€æ…‹é¡
                notesBtn.classList.remove('btn-secondary'); // ç§»é™¤æ¬¡è¦æŒ‰éˆ•é¡
            } else { // å¦‚æœç­†è¨˜æ¨¡å¼é—œé–‰
                notesBtn.classList.remove('btn-on'); // ç§»é™¤é–‹å•Ÿç‹€æ…‹é¡
                notesBtn.classList.add('btn-secondary'); // æ·»åŠ æ¬¡è¦æŒ‰éˆ•é¡
            }
            
            // æ›´æ–°ç­†è¨˜é¡¯ç¤º
            if (notesEnabled) updateNotes(); // æ›´æ–°ç­†è¨˜é¡¯ç¤º
            else clearNotes(); // æ¸…é™¤ç­†è¨˜é¡¯ç¤º
            
            // æ›´æ–°é«˜äº®é¡¯ç¤º
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
        }

        /**
         * æ¸…é™¤æ‰€æœ‰ç­†è¨˜
         * æ¸…ç©ºæ‰€æœ‰å–®å…ƒæ ¼ä¸­çš„å€™é¸æ•¸å­—é¡¯ç¤º
         */
        function clearNotes() {
            document.querySelectorAll('.note-num').forEach(el => el.innerText = ''); // æ¸…ç©ºæ‰€æœ‰ç­†è¨˜æ•¸å­—
        }

        /**
         * æ›´æ–°ç­†è¨˜é¡¯ç¤º
         * é¡¯ç¤ºæ¯å€‹ç©ºç™½å–®å…ƒæ ¼ä¸­å¯èƒ½çš„å€™é¸æ•¸å­—
         * å€™é¸æ•¸å­—æ˜¯æ ¹æ“šç•¶å‰ç›¤é¢ç‹€æ…‹è¨ˆç®—å¾—å‡ºçš„å¯èƒ½æ­£ç¢ºçš„æ•¸å­—
         */
        function updateNotes() {
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    const cell = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
                    const noteContainer = cell.querySelector('.notes-grid'); // ç²å–ç­†è¨˜å®¹å™¨
                    
                    // æ¸…ç©ºç¾æœ‰ç­†è¨˜
                    noteContainer.querySelectorAll('.note-num').forEach(n => n.innerText = ''); // æ¸…ç©ºç­†è¨˜æ•¸å­—
                    
                    // å¦‚æœæ˜¯ç©ºç™½å–®å…ƒæ ¼ï¼Œè¨ˆç®—ä¸¦é¡¯ç¤ºå€™é¸æ•¸å­—
                    if (board[r][c] === 0 && initial[r][c] === 0) { // å¦‚æœå–®å…ƒæ ¼æ˜¯ç©ºç™½ä¸”ä¸æ˜¯åˆå§‹ç·šç´¢
                        // åˆä½µåˆå§‹ç›¤é¢å’Œç©å®¶è¼¸å…¥ï¼Œç”¨æ–¼æª¢æŸ¥å€™é¸æ•¸å­—
                        let combinedGrid = JSON.parse(JSON.stringify(initial)); // æ·±æ‹·è²åˆå§‹ç›¤é¢
                        for (let i = 0; i < 9; i++) { // éæ­·æ¯ä¸€è¡Œ
                            for (let j = 0; j < 9; j++) { // éæ­·æ¯ä¸€åˆ—
                                if (board[i][j] !== 0) combinedGrid[i][j] = board[i][j]; // å¦‚æœç©å®¶æœ‰è¼¸å…¥ï¼Œæ›´æ–°åˆä½µç›¤é¢
                            }
                        }
                        
                        // æª¢æŸ¥æ¯å€‹æ•¸å­—æ˜¯å¦å¯å®‰å…¨å¡«å…¥
                        for (let n = 1; n <= 9; n++) { // å˜—è©¦æ•¸å­—1-9
                            if (isSafe(combinedGrid, r, c, n)) { // å¦‚æœæ•¸å­—å®‰å…¨
                                noteContainer.querySelector(`.note-num[data-num='${n}']`).innerText = n; // é¡¯ç¤ºå€™é¸æ•¸å­—
                            }
                        }
                    }
                }
            }
        }

        /**
         * æ›´æ–°é«˜äº®é¡¯ç¤º
         * é«˜äº®ç›¸é—œå–®å…ƒæ ¼ï¼ˆåŒä¸€è¡Œã€åˆ—å’Œå®®æ ¼ï¼‰å’Œç›¸åŒæ•¸å­—
         * ç•¶é¸ä¸­ä¸€å€‹å–®å…ƒæ ¼æ™‚ï¼Œçªå‡ºé¡¯ç¤ºæ‰€æœ‰ç›¸é—œå–®å…ƒæ ¼å’Œç›¸åŒæ•¸å­—çš„å–®å…ƒæ ¼
         */
        function updateHighlighting() {
            // æ¸…é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.cell').forEach(c => { // éæ­·æ‰€æœ‰å–®å…ƒæ ¼
                c.classList.remove('selected', 'highlight-related', 'highlight-same'); // ç§»é™¤é«˜äº®é¡
            });
            
            document.querySelectorAll('.note-num').forEach(n => { // éæ­·æ‰€æœ‰ç­†è¨˜æ•¸å­—
                n.classList.remove('highlighted'); // ç§»é™¤é«˜äº®é¡
            });
            
            document.querySelectorAll('.numpad-btn').forEach(b => { // éæ­·æ‰€æœ‰æ•¸å­—æŒ‰éˆ•
                b.classList.remove('suggested'); // ç§»é™¤å»ºè­°é¡
            });
            
            // å¦‚æœæ²’æœ‰é¸ä¸­å–®å…ƒæ ¼ï¼Œç›´æ¥è¿”å›
            if (!selectedCell) return;
            
            const { r, c } = selectedCell; // è§£æ§‹é¸ä¸­å–®å…ƒæ ¼åº§æ¨™
            
            // ç²å–ç•¶å‰é¸ä¸­å–®å…ƒæ ¼çš„å€¼
            const val = board[r][c] !== 0 ? board[r][c] : initial[r][c]; // å„ªå…ˆä½¿ç”¨ç©å®¶è¼¸å…¥ï¼Œå¦å‰‡ä½¿ç”¨åˆå§‹ç·šç´¢
            
            // è¨ˆç®—ç•¶å‰å–®å…ƒæ ¼æ‰€åœ¨çš„3x3å®®æ ¼èµ·å§‹ä½ç½®
            const startRow = r - r % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹è¡Œ
            const startCol = c - c % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹åˆ—
            
            // é«˜äº®åŒä¸€è¡Œå’ŒåŒä¸€åˆ—çš„å–®å…ƒæ ¼
            for (let i = 0; i < 9; i++) { // éæ­·è¡Œå’Œåˆ—
                getCellDiv(r, i).classList.add('highlight-related'); // é«˜äº®åŒä¸€è¡Œå–®å…ƒæ ¼
                getCellDiv(i, c).classList.add('highlight-related'); // é«˜äº®åŒä¸€åˆ—å–®å…ƒæ ¼
            }
            
            // é«˜äº®åŒä¸€3x3å®®æ ¼çš„å–®å…ƒæ ¼
            for (let i = 0; i < 3; i++) { // éæ­·å®®æ ¼çš„è¡Œ
                for (let j = 0; j < 3; j++) { // éæ­·å®®æ ¼çš„åˆ—
                    getCellDiv(startRow + i, startCol + j).classList.add('highlight-related'); // é«˜äº®åŒä¸€å®®æ ¼å–®å…ƒæ ¼
                }
            }
            
            // é«˜äº®é¸ä¸­çš„å–®å…ƒæ ¼
            getCellDiv(r, c).classList.add('selected'); // é«˜äº®é¸ä¸­å–®å…ƒæ ¼
            
            // å¦‚æœé¸ä¸­çš„å–®å…ƒæ ¼æœ‰æ•¸å­—ï¼Œé«˜äº®æ‰€æœ‰ç›¸åŒæ•¸å­—çš„å–®å…ƒæ ¼
            if (val !== 0) { // å¦‚æœå–®å…ƒæ ¼æœ‰æ•¸å­—
                for (let i = 0; i < 9; i++) { // éæ­·æ¯ä¸€è¡Œ
                    for (let j = 0; j < 9; j++) { // éæ­·æ¯ä¸€åˆ—
                        const cellVal = board[i][j] !== 0 ? board[i][j] : initial[i][j]; // ç²å–å–®å…ƒæ ¼å€¼
                        if (cellVal === val) { // å¦‚æœå€¼ç›¸åŒ
                            getCellDiv(i, j).classList.add('highlight-same'); // é«˜äº®ç›¸åŒæ•¸å­—å–®å…ƒæ ¼
                        }
                    }
                }
                
                // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œé«˜äº®ç­†è¨˜ä¸­çš„ç›¸åŒæ•¸å­—
                if (notesEnabled) { // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨
                    document.querySelectorAll(`.note-num[data-num='${val}']`).forEach(noteEl => { // éæ­·ç›¸åŒæ•¸å­—çš„ç­†è¨˜
                        if (noteEl.innerText === String(val)) { // å¦‚æœç­†è¨˜æ•¸å­—ç­‰æ–¼é¸ä¸­æ•¸å­—
                            noteEl.classList.add('highlighted'); // é«˜äº®ç­†è¨˜æ•¸å­—
                        }
                    });
                }
            }
            
            // åƒ…åœ¨é¸ä¸­å–®å…ƒæ ¼ç‚ºç©ºç™½æ™‚æª¢æŸ¥ä¸¦çªå‡ºé¡¯ç¤ºå»ºè­°æ•¸å­—
            if (board[r][c] === 0 && initial[r][c] === 0) { // å¦‚æœé¸ä¸­å–®å…ƒæ ¼ç‚ºç©ºç™½ä¸”ä¸æ˜¯åˆå§‹ç·šç´¢
                checkGroupAndHighlight(r, c); // æª¢æŸ¥ä¸¦çªå‡ºé¡¯ç¤ºå»ºè­°æ•¸å­—
            }
        }

        /**
         * æª¢æŸ¥è¡Œã€åˆ—æˆ–å®®æ˜¯å¦å·²å¡«å…¥8å€‹æ•¸å­—ï¼Œå¦‚æœæ˜¯å‰‡çªå‡ºé¡¯ç¤ºç­”æ¡ˆ
         * åƒ…ç•¶é¸ä¸­å–®å…ƒæ ¼ç‚ºç©ºç™½ä¸”æ˜¯å”¯ä¸€ç¼ºå¤±çš„æ•¸å­—æ™‚æ‰çªå‡ºé¡¯ç¤º
         * @param {number} r - è¡Œç´¢å¼•
         * @param {number} c - åˆ—ç´¢å¼•
         */
        function checkGroupAndHighlight(r, c) {
            // æª¢æŸ¥è¡Œ
            let rowValues = []; // è¡Œå€¼æ•¸çµ„
            for (let i = 0; i < 9; i++) { // éæ­·åŒä¸€è¡Œçš„æ‰€æœ‰å–®å…ƒæ ¼
                const val = board[r][i] !== 0 ? board[r][i] : initial[r][i]; // ç²å–å–®å…ƒæ ¼å€¼
                rowValues.push(val); // æ·»åŠ åˆ°è¡Œå€¼æ•¸çµ„
            }
            let rowMissing = findMissingNumber(rowValues); // æŸ¥æ‰¾ç¼ºå¤±çš„æ•¸å­—
            if (rowMissing !== -1) { // å¦‚æœæ‰¾åˆ°å”¯ä¸€ç¼ºå¤±çš„æ•¸å­—
                highlightSuggestedNumber(rowMissing); // çªå‡ºé¡¯ç¤ºå»ºè­°æ•¸å­—
                return; // è¿”å›ï¼Œä¸å†æª¢æŸ¥å…¶ä»–çµ„
            }
            
            // æª¢æŸ¥åˆ—
            let colValues = []; // åˆ—å€¼æ•¸çµ„
            for (let i = 0; i < 9; i++) { // éæ­·åŒä¸€åˆ—çš„æ‰€æœ‰å–®å…ƒæ ¼
                const val = board[i][c] !== 0 ? board[i][c] : initial[i][c]; // ç²å–å–®å…ƒæ ¼å€¼
                colValues.push(val); // æ·»åŠ åˆ°åˆ—å€¼æ•¸çµ„
            }
            let colMissing = findMissingNumber(colValues); // æŸ¥æ‰¾ç¼ºå¤±çš„æ•¸å­—
            if (colMissing !== -1) { // å¦‚æœæ‰¾åˆ°å”¯ä¸€ç¼ºå¤±çš„æ•¸å­—
                highlightSuggestedNumber(colMissing); // çªå‡ºé¡¯ç¤ºå»ºè­°æ•¸å­—
                return; // è¿”å›ï¼Œä¸å†æª¢æŸ¥å…¶ä»–çµ„
            }
            
            // æª¢æŸ¥å®®
            let boxValues = []; // å®®å€¼æ•¸çµ„
            const startRow = r - r % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹è¡Œ
            const startCol = c - c % 3; // è¨ˆç®—å®®æ ¼èµ·å§‹åˆ—
            for (let i = 0; i < 3; i++) { // éæ­·å®®æ ¼çš„è¡Œ
                for (let j = 0; j < 3; j++) { // éæ­·å®®æ ¼çš„åˆ—
                    const val = board[startRow + i][startCol + j] !== 0 ? 
                                board[startRow + i][startCol + j] : 
                                initial[startRow + i][startCol + j]; // ç²å–å–®å…ƒæ ¼å€¼
                    boxValues.push(val); // æ·»åŠ åˆ°å®®å€¼æ•¸çµ„
                }
            }
            let boxMissing = findMissingNumber(boxValues); // æŸ¥æ‰¾ç¼ºå¤±çš„æ•¸å­—
            if (boxMissing !== -1) { // å¦‚æœæ‰¾åˆ°å”¯ä¸€ç¼ºå¤±çš„æ•¸å­—
                highlightSuggestedNumber(boxMissing); // çªå‡ºé¡¯ç¤ºå»ºè­°æ•¸å­—
                return; // è¿”å›
            }
        }

        /**
         * åœ¨æ•¸å­—çµ„ä¸­æŸ¥æ‰¾ç¼ºå¤±çš„æ•¸å­—
         * @param {Array} values - æ•¸å­—çµ„
         * @returns {number} ç¼ºå¤±çš„æ•¸å­—ï¼Œå¦‚æœæ²’æœ‰æˆ–æœ‰å¤šå€‹ç¼ºå¤±å‰‡è¿”å›-1
         */
        function findMissingNumber(values) {
            let missing = 0; // ç¼ºå¤±çš„æ•¸å­—
            let count = 0; // ç¼ºå¤±æ•¸å­—è¨ˆæ•¸
            for (let i = 1; i <= 9; i++) { // éæ­·æ•¸å­—1-9
                if (!values.includes(i)) { // å¦‚æœæ•¸å­—ä¸åœ¨æ•¸çµ„ä¸­
                    missing = i; // è¨˜éŒ„ç¼ºå¤±çš„æ•¸å­—
                    count++; // å¢åŠ ç¼ºå¤±è¨ˆæ•¸
                }
            }
            return count === 1 ? missing : -1; // å¦‚æœåªæœ‰ä¸€å€‹ç¼ºå¤±æ•¸å­—ï¼Œè¿”å›è©²æ•¸å­—ï¼Œå¦å‰‡è¿”å›-1
        }

        /**
         * çªå‡ºé¡¯ç¤ºå»ºè­°çš„æ•¸å­—
         * @param {number} num - è¦çªå‡ºé¡¯ç¤ºçš„æ•¸å­—
         */
        function highlightSuggestedNumber(num) {
            const btn = document.getElementById(`btn-num-${num}`); // ç²å–å°æ‡‰çš„æ•¸å­—æŒ‰éˆ•
            if (btn) { // å¦‚æœæŒ‰éˆ•å­˜åœ¨
                btn.classList.add('suggested'); // æ·»åŠ å»ºè­°é¡
            }
        }

        /**
         * æ›´æ–°æ•¸å­—çµ±è¨ˆ
         * é¡¯ç¤ºæ¯å€‹æ•¸å­—é‚„éœ€è¦å¡«å¯«çš„æ•¸é‡
         * ç•¶æ•¸å­—å·²å®Œæˆæ™‚ï¼Œå°‡å°æ‡‰çš„æ•¸å­—æŒ‰éˆ•è®Šæ·¡
         */
        function updateCounts() {
            // é‡ç½®è¨ˆæ•¸å™¨
            counts.fill(9); // å°‡è¨ˆæ•¸å™¨æ•¸çµ„é‡ç½®ç‚º9
            
            // çµ±è¨ˆå·²å¡«å¯«çš„æ•¸å­—
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    const val = board[r][c] !== 0 ? board[r][c] : initial[r][c]; // ç²å–å–®å…ƒæ ¼å€¼
                    if (val !== 0) counts[val]--; // å¦‚æœå–®å…ƒæ ¼æœ‰æ•¸å­—ï¼Œæ¸›å°‘å°æ‡‰æ•¸å­—çš„è¨ˆæ•¸
                }
            }
            
            // æ›´æ–°æ•¸å­—éµç›¤é¡¯ç¤º
            for (let i = 1; i <= 9; i++) { // éæ­·æ•¸å­—1-9
                const btn = document.getElementById(`btn-num-${i}`); // ç²å–æ•¸å­—æŒ‰éˆ•
                btn.querySelector('.count').innerText = counts[i]; // æ›´æ–°è¨ˆæ•¸é¡¯ç¤º
                
                // å¦‚æœæ•¸å­—å·²å®Œæˆï¼Œå°‡æŒ‰éˆ•è®Šæ·¡
                if (counts[i] <= 0) { // å¦‚æœæ•¸å­—å·²å®Œæˆ
                    btn.classList.add('faded'); // æ·»åŠ è®Šæ·¡é¡
                } else { // å¦‚æœæ•¸å­—æœªå®Œæˆ
                    btn.classList.remove('faded'); // ç§»é™¤è®Šæ·¡é¡
                }
            }
        }

        /**
         * æª¢æŸ¥éŠæˆ²æ˜¯å¦å®Œæˆ
         * æ¯”è¼ƒç•¶å‰ç›¤é¢èˆ‡è§£ç­”ï¼Œå¦‚æœå®Œå…¨ç›¸åŒå‰‡éŠæˆ²å®Œæˆ
         */
        function checkWin() {
            let isFull = true; // æ˜¯å¦å®Œæˆçš„æ¨™èªŒ
            
            // æª¢æŸ¥æ¯å€‹å–®å…ƒæ ¼æ˜¯å¦æ­£ç¢ºå¡«å¯«
            for (let r = 0; r < 9; r++) { // éæ­·æ¯ä¸€è¡Œ
                for (let c = 0; c < 9; c++) { // éæ­·æ¯ä¸€åˆ—
                    const cellVal = board[r][c] !== 0 ? board[r][c] : initial[r][c]; // ç²å–å–®å…ƒæ ¼å€¼
                    if (cellVal !== solution[r][c]) { // å¦‚æœå–®å…ƒæ ¼å€¼ä¸ç­‰æ–¼è§£ç­”
                        isFull = false; // è¨­ç½®ç‚ºæœªå®Œæˆ
                        break; // è·³å‡ºå…§å±¤å¾ªç’°
                    }
                }
                if (!isFull) break; // å¦‚æœæœªå®Œæˆï¼Œè·³å‡ºå¤–å±¤å¾ªç’°
            }
            
            // å¦‚æœæ‰€æœ‰å–®å…ƒæ ¼éƒ½æ­£ç¢ºï¼Œé¡¯ç¤ºå‹åˆ©ç•Œé¢
            if (isFull) { // å¦‚æœéŠæˆ²å®Œæˆ
                gameOver = true; // è¨­ç½®éŠæˆ²çµæŸæ¨™èªŒ
                stopTimer(); // åœæ­¢è¨ˆæ™‚å™¨
                playSound('win'); // æ’­æ”¾å‹åˆ©éŸ³æ•ˆ
                
                // æ›´æ–°å‹åˆ©ç•Œé¢ä¿¡æ¯
                document.getElementById('victory-time-text').innerText = `Time: ${updateTimerDisplay()}`; // æ›´æ–°è€—æ™‚é¡¯ç¤º
                document.getElementById('victory-stats').innerText = `Errors: ${errorCount.toString().padStart(2, '0')}, Hints: ${hintCount.toString().padStart(2, '0')}`; // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
                
                // é¡¯ç¤ºå‹åˆ©ç•Œé¢
                showVictoryScreen(); // é¡¯ç¤ºå‹åˆ©ç•«é¢
                
                // æ¸…é™¤æ‰€æœ‰é«˜äº®
                document.querySelectorAll('.cell').forEach(c => { // éæ­·æ‰€æœ‰å–®å…ƒæ ¼
                    c.classList.remove('selected', 'highlight-related', 'highlight-same'); // ç§»é™¤é«˜äº®é¡
                });
            }
        }

        /**
         * é¡¯ç¤ºå‹åˆ©ç•«é¢
         * å‰µå»ºè–èª•ç‡ˆè£é£¾ä¸¦é¡¯ç¤ºå‹åˆ©ç•Œé¢
         */
        function showVictoryScreen() {
            // é¡¯ç¤ºå‹åˆ©ç•Œé¢
            document.getElementById('victory-overlay').style.display = 'flex'; // é¡¯ç¤ºå‹åˆ©ç•Œé¢
            
            // å‰µå»ºè–èª•ç‡ˆè£é£¾
            createChristmasLights(); // å‰µå»ºè–èª•ç‡ˆè£é£¾
        }

        /**
         * å‰µå»ºè–èª•ç‡ˆè£é£¾
         * åœ¨å‹åˆ©ç•Œé¢é ‚éƒ¨å‰µå»ºä¸€æ’é–ƒçˆçš„è–èª•ç‡ˆ
         */
        function createChristmasLights() {
            const lightsContainer = document.getElementById('christmas-lights'); // ç²å–è–èª•ç‡ˆå®¹å™¨
            lightsContainer.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹
            
            // è–èª•ç‡ˆé¡è‰²æ•¸çµ„
            const lightColors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8000', '#8000ff'];
            
            // å‰µå»ºå¤šå€‹è–èª•ç‡ˆ
            for (let i = 0; i < 12; i++) { // å‰µå»º12å€‹è–èª•ç‡ˆ
                const light = document.createElement('div'); // å‰µå»ºè–èª•ç‡ˆå…ƒç´ 
                light.className = 'light'; // è¨­ç½®é¡å
                light.style.backgroundColor = lightColors[i % lightColors.length]; // è¨­ç½®èƒŒæ™¯é¡è‰²
                light.style.animationDelay = `${i * 0.2}s`; // è¨­ç½®å‹•ç•«å»¶é²ï¼Œå‰µé€ æ³¢æµªæ•ˆæœ
                
                lightsContainer.appendChild(light); // å°‡è–èª•ç‡ˆæ·»åŠ åˆ°å®¹å™¨
            }
        }

        /**
         * é—œé–‰å‹åˆ©ç•Œé¢
         * éš±è—å‹åˆ©å½ˆçª—ï¼Œè¿”å›éŠæˆ²ç•Œé¢
         */
        function closeOverlay() {
            document.getElementById('victory-overlay').style.display = 'none'; // éš±è—å‹åˆ©ç•Œé¢
            
            // é–‹å§‹æ–°éŠæˆ²
            startNewGame(); // é–‹å§‹æ–°éŠæˆ²
        }

        /**
         * åˆ‡æ›éŸ³æ•ˆé–‹é—œ
         * é–‹å•Ÿæˆ–é—œé–‰éŠæˆ²éŸ³æ•ˆ
         */
        function toggleSound() {
            // åˆ‡æ›éŸ³æ•ˆç‹€æ…‹
            soundEnabled = !soundEnabled; // åˆ‡æ›éŸ³æ•ˆç‹€æ…‹
            
            // æ›´æ–°æŒ‰éˆ•åœ–æ¨™ï¼Œä¸å†æ”¹è®ŠèƒŒæ™¯é¡è‰²
            const soundBtn = document.getElementById('btn-sound'); // ç²å–éŸ³æ•ˆæŒ‰éˆ•
            if (soundEnabled) { // å¦‚æœéŸ³æ•ˆé–‹å•Ÿ
                soundBtn.innerHTML = 'ğŸ”Š'; // è¨­ç½®ç‚ºå–‡å­åœ–æ¨™
                soundBtn.title = 'Sound On'; // æ›´æ–°æç¤ºæ–‡å­—
            } else { // å¦‚æœéŸ³æ•ˆé—œé–‰
                soundBtn.innerHTML = 'ğŸ”‡'; // è¨­ç½®ç‚ºéœéŸ³åœ–æ¨™
                soundBtn.title = 'Sound Off'; // æ›´æ–°æç¤ºæ–‡å­—
            }
        }
    </script>
</body>
</html>